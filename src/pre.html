<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.640">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ATP-Tennis-Aalysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="pre_files/libs/clipboard/clipboard.min.js"></script>
<script src="pre_files/libs/quarto-html/quarto.js"></script>
<script src="pre_files/libs/quarto-html/popper.min.js"></script>
<script src="pre_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="pre_files/libs/quarto-html/anchor.min.js"></script>
<link href="pre_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="pre_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="pre_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="pre_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="pre_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#pca" id="toc-pca" class="nav-link active" data-scroll-target="#pca">PCA</a></li>
  <li><a href="#ml" id="toc-ml" class="nav-link" data-scroll-target="#ml">ML</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ATP-Tennis-Aalysis</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>The main idea for the project is to think of how can I help the player to increase his chances to win a game. This will be done bt the following steps : #### EDA - For exploring the attributes for the top ranked players and what is special about them. Is there any common attributes ? #### clustering - Does the top ranked players are cluster in one group and mid rank in one group.. - Grouping the players can help to form a strategy for the game, understand the playing style for the opponent i - use it to improve the result of the prediction #### Prediction - Now the player knows his opponent and have a plan for the game. The next step will be trying to predict the result of the game For the classification : Logistic Reg., SVM classification, Random forest For regression (can we predict the other sets results based on the first set stats ?) : Linear, SVM, Random forest.</p>
<section id="game-simulation" class="level4">
<h4 class="anchored" data-anchor-id="game-simulation">Game simulation</h4>
<ul>
<li>Match strategy, tactics, and analysis</li>
<li>Training regimens and focus</li>
<li>Match outcome and tournament table prediction</li>
</ul>
<p>A successful outcome for the project would be the creation of both a classification model capable of predicting a future game’s outcome, and a regression model capable of predicting a future game’s score.</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> KNNImputer</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Modeling process</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, GridSearchCV</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, classification_report, roc_auc_score, roc_curve, precision_score, accuracy_score, recall_score, f1_score</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder, StandardScaler</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> SelectKBest</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> chi2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>I have two data sources as referenced on the README file. The first Reposotry contains basic information about every match. The second one has detailed information for selected matches. In this section, I will join the data from the first Repository and the second Repository. This will enable me to have an in depth analysis on the players and more accurate results on the ML part. The steps for this is as follows : 1- cbind the target fetures from the second Repo into one Dataset 2- cbind the dataset of the extra fetures with the first Repo dataset 3- Clean the final dataset</p>
<p>charting-m-stats-Overview dataset</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>overview_p2 <span class="op">=</span> pd.read_csv(<span class="st">'../data/charting-m-stats-Overview.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>overview_p2 <span class="op">=</span> overview_p2.loc[overview_p2[<span class="st">'set'</span>] <span class="op">==</span> <span class="st">'Total'</span>, :]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>overview_p2</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>match_id</th>
      <th>player</th>
      <th>set</th>
      <th>serve_pts</th>
      <th>aces</th>
      <th>dfs</th>
      <th>first_in</th>
      <th>first_won</th>
      <th>second_in</th>
      <th>second_won</th>
      <th>bk_pts</th>
      <th>bp_saved</th>
      <th>return_pts</th>
      <th>return_pts_won</th>
      <th>winners</th>
      <th>winners_fh</th>
      <th>winners_bh</th>
      <th>unforced</th>
      <th>unforced_fh</th>
      <th>unforced_bh</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>19751219-M-Davis_Cup_World_Group_F-RR-Bjorn_Bo...</td>
      <td>1</td>
      <td>Total</td>
      <td>69</td>
      <td>2</td>
      <td>1</td>
      <td>32</td>
      <td>25</td>
      <td>37</td>
      <td>21</td>
      <td>5</td>
      <td>4</td>
      <td>63</td>
      <td>36</td>
      <td>28</td>
      <td>10</td>
      <td>16</td>
      <td>16</td>
      <td>6</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>19751219-M-Davis_Cup_World_Group_F-RR-Bjorn_Bo...</td>
      <td>2</td>
      <td>Total</td>
      <td>63</td>
      <td>2</td>
      <td>2</td>
      <td>41</td>
      <td>20</td>
      <td>22</td>
      <td>7</td>
      <td>12</td>
      <td>4</td>
      <td>69</td>
      <td>23</td>
      <td>14</td>
      <td>8</td>
      <td>4</td>
      <td>26</td>
      <td>15</td>
      <td>9</td>
    </tr>
    <tr>
      <th>8</th>
      <td>19780125-M-Pepsi_Grand_Slam-SF-Brian_Gottfried...</td>
      <td>1</td>
      <td>Total</td>
      <td>55</td>
      <td>0</td>
      <td>1</td>
      <td>32</td>
      <td>21</td>
      <td>23</td>
      <td>9</td>
      <td>9</td>
      <td>5</td>
      <td>49</td>
      <td>14</td>
      <td>11</td>
      <td>7</td>
      <td>4</td>
      <td>31</td>
      <td>9</td>
      <td>21</td>
    </tr>
    <tr>
      <th>9</th>
      <td>19780125-M-Pepsi_Grand_Slam-SF-Brian_Gottfried...</td>
      <td>2</td>
      <td>Total</td>
      <td>49</td>
      <td>0</td>
      <td>2</td>
      <td>31</td>
      <td>25</td>
      <td>18</td>
      <td>10</td>
      <td>1</td>
      <td>0</td>
      <td>55</td>
      <td>25</td>
      <td>15</td>
      <td>8</td>
      <td>7</td>
      <td>21</td>
      <td>7</td>
      <td>12</td>
    </tr>
    <tr>
      <th>14</th>
      <td>19800705-M-Wimbledon-F-John_Mcenroe-Bjorn_Borg</td>
      <td>1</td>
      <td>Total</td>
      <td>180</td>
      <td>12</td>
      <td>3</td>
      <td>111</td>
      <td>75</td>
      <td>69</td>
      <td>44</td>
      <td>14</td>
      <td>10</td>
      <td>196</td>
      <td>65</td>
      <td>69</td>
      <td>28</td>
      <td>29</td>
      <td>102</td>
      <td>29</td>
      <td>70</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19717</th>
      <td>20220712-M-Bastad-R32-Emil_Ruusuvuori-Dominic_...</td>
      <td>2</td>
      <td>Total</td>
      <td>98</td>
      <td>7</td>
      <td>3</td>
      <td>69</td>
      <td>45</td>
      <td>29</td>
      <td>14</td>
      <td>12</td>
      <td>8</td>
      <td>89</td>
      <td>40</td>
      <td>31</td>
      <td>12</td>
      <td>12</td>
      <td>44</td>
      <td>27</td>
      <td>14</td>
    </tr>
    <tr>
      <th>19724</th>
      <td>20220706-M-Wimbledon-QF-Nick_Kyrgios-Cristian_...</td>
      <td>1</td>
      <td>Total</td>
      <td>114</td>
      <td>17</td>
      <td>4</td>
      <td>81</td>
      <td>59</td>
      <td>33</td>
      <td>14</td>
      <td>9</td>
      <td>8</td>
      <td>88</td>
      <td>32</td>
      <td>62</td>
      <td>11</td>
      <td>4</td>
      <td>42</td>
      <td>21</td>
      <td>17</td>
    </tr>
    <tr>
      <th>19725</th>
      <td>20220706-M-Wimbledon-QF-Nick_Kyrgios-Cristian_...</td>
      <td>2</td>
      <td>Total</td>
      <td>88</td>
      <td>2</td>
      <td>5</td>
      <td>63</td>
      <td>43</td>
      <td>25</td>
      <td>13</td>
      <td>6</td>
      <td>3</td>
      <td>114</td>
      <td>41</td>
      <td>44</td>
      <td>16</td>
      <td>8</td>
      <td>33</td>
      <td>15</td>
      <td>13</td>
    </tr>
    <tr>
      <th>19732</th>
      <td>20220713-M-Newport-R16-Andy_Murray-Max_Purcell</td>
      <td>1</td>
      <td>Total</td>
      <td>87</td>
      <td>8</td>
      <td>5</td>
      <td>50</td>
      <td>35</td>
      <td>37</td>
      <td>16</td>
      <td>11</td>
      <td>7</td>
      <td>80</td>
      <td>44</td>
      <td>25</td>
      <td>10</td>
      <td>7</td>
      <td>23</td>
      <td>11</td>
      <td>7</td>
    </tr>
    <tr>
      <th>19733</th>
      <td>20220713-M-Newport-R16-Andy_Murray-Max_Purcell</td>
      <td>2</td>
      <td>Total</td>
      <td>80</td>
      <td>5</td>
      <td>1</td>
      <td>45</td>
      <td>22</td>
      <td>35</td>
      <td>14</td>
      <td>15</td>
      <td>8</td>
      <td>87</td>
      <td>36</td>
      <td>23</td>
      <td>10</td>
      <td>8</td>
      <td>39</td>
      <td>21</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
<p>5200 rows × 20 columns</p>
</div>
</div>
</div>
<p><strong>Merge the other datasets from the same Repo</strong></p>
<p>ReturnDepth dataset</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.read_csv(<span class="st">'../data/charting-m-stats-ReturnDepth.csv'</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Return- w_ReturenSh,w_ReturenD,w_ReturenVD</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Returen Outcome- w_ReturenWon</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> df2.columns.tolist()</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df2.rename_axis([<span class="bu">str</span>(x) <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">8</span>)]).reset_index()</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df2.set_axis(col<span class="op">+</span>[<span class="bu">str</span>(x) <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">8</span>)], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>df2.drop([<span class="bu">str</span>(x) <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">8</span>)], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>df2[[<span class="st">'tourney_date'</span>, <span class="st">'sm'</span>, <span class="st">'tourney_name'</span>, <span class="st">'sm2'</span>, <span class="st">'player1'</span>, <span class="st">'player2'</span>]</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    ] <span class="op">=</span> df2[<span class="st">'match_id'</span>].<span class="bu">str</span>.split(<span class="st">'-'</span>, <span class="dv">6</span>, expand<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># df2.loc[:,['player1','player2']]=df2.loc[:,['player1','player2']].applymap(lambda x: x.replace('_',' ') ) #for multiple columns</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df2.loc[df2[<span class="st">'row'</span>] <span class="op">==</span> <span class="st">'Total'</span>, :]</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># So I want to change the value of the column player from 1 to the value of the name in column player1</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 1,16,17 are the index</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># for i in range(len(df2)) :</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     df2.iloc[i,1] = np.where(df2.iloc[i,1] == 1, df2.iloc[i,16], df2.iloc[i,17])</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>df2.drop([<span class="st">'player1'</span>, <span class="st">'player2'</span>, <span class="st">'sm'</span>, <span class="st">'sm2'</span>, <span class="st">'tourney_name'</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">'tourney_date'</span>, <span class="st">'unforced'</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>df2.rename(columns<span class="op">=</span>{<span class="st">'row'</span>: <span class="st">'set'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>df2.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 5198 entries, 0 to 93017
Data columns (total 11 columns):
 #   Column         Non-Null Count  Dtype 
---  ------         --------------  ----- 
 0   match_id       5198 non-null   object
 1   player         5198 non-null   int64 
 2   set            5198 non-null   object
 3   returnable     5198 non-null   int64 
 4   shallow        5198 non-null   int64 
 5   deep           5198 non-null   int64 
 6   very_deep      5198 non-null   int64 
 7   err_net        5198 non-null   int64 
 8   err_deep       5198 non-null   int64 
 9   err_wide       5198 non-null   int64 
 10  err_wide_deep  5198 non-null   int64 
dtypes: int64(9), object(2)
memory usage: 487.3+ KB</code></pre>
</div>
</div>
<p>ShotDirection dataset</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df4 <span class="op">=</span> pd.read_csv(<span class="st">'../data/charting-m-stats-ShotDirection.csv'</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> df4.columns.tolist()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df4 <span class="op">=</span> df4.rename_axis([<span class="bu">str</span>(x) <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">12</span>)]).reset_index()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>df4 <span class="op">=</span> df4.set_axis(col<span class="op">+</span>[<span class="bu">str</span>(x) <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">12</span>)], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>df4.drop([<span class="bu">str</span>(x) <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">12</span>)], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>df4[[<span class="st">'tourney_date'</span>, <span class="st">'sm'</span>, <span class="st">'tourney_name'</span>, <span class="st">'sm2'</span>, <span class="st">'player1'</span>, <span class="st">'player2'</span>]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    ] <span class="op">=</span> df4[<span class="st">'match_id'</span>].<span class="bu">str</span>.split(<span class="st">'-'</span>, <span class="dv">6</span>, expand<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># df4.loc[:,['player1','player2']]=df4.loc[:,['player1','player2']].applymap(lambda x: x.replace('_',' ') ) #for multiple columns</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>df4 <span class="op">=</span> df4.loc[df4[<span class="st">'row'</span>] <span class="op">==</span> <span class="st">'Total'</span>, :]</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># So I want to change the value of the column player from 1 to the value of the name in column player1</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 1,16,17 are the index</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># for i in range(len(df4)) :</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     df4.iloc[i,1] = np.where(df4.iloc[i,1] == 1, df4.iloc[i,12], df4.iloc[i,13])</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>df4.rename(columns<span class="op">=</span>{<span class="st">'row'</span>: <span class="st">'set'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>df4.drop([<span class="st">'player1'</span>, <span class="st">'player2'</span>, <span class="st">'sm'</span>, <span class="st">'sm2'</span>, <span class="st">'tourney_name'</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">'tourney_date'</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>df4.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 5201 entries, 0 to 20610
Data columns (total 8 columns):
 #   Column         Non-Null Count  Dtype 
---  ------         --------------  ----- 
 0   match_id       5201 non-null   object
 1   player         5201 non-null   int64 
 2   set            5201 non-null   object
 3   crosscourt     5201 non-null   int64 
 4   down_middle    5201 non-null   int64 
 5   down_the_line  5201 non-null   int64 
 6   inside_out     5201 non-null   int64 
 7   inside_in      5201 non-null   int64 
dtypes: int64(6), object(2)
memory usage: 365.7+ KB</code></pre>
</div>
</div>
<p>merge all the datasets</p>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>overview_p2 <span class="op">=</span> pd.merge(overview_p2,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                       df2,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                       on<span class="op">=</span>[<span class="st">'match_id'</span>, <span class="st">'set'</span>, <span class="st">'player'</span>],</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                       how<span class="op">=</span><span class="st">"right"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>overview_p2 <span class="op">=</span> pd.merge(overview_p2,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                       df4,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                       on<span class="op">=</span>[<span class="st">'match_id'</span>, <span class="st">'set'</span>, <span class="st">'player'</span>],</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                       how<span class="op">=</span><span class="st">"right"</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>overview_p2.drop_duplicates(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>overview_p2.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 5193 entries, 0 to 5248
Data columns (total 33 columns):
 #   Column          Non-Null Count  Dtype  
---  ------          --------------  -----  
 0   match_id        5193 non-null   object 
 1   player          5193 non-null   int64  
 2   set             5193 non-null   object 
 3   serve_pts       5186 non-null   float64
 4   aces            5186 non-null   float64
 5   dfs             5186 non-null   float64
 6   first_in        5186 non-null   float64
 7   first_won       5186 non-null   float64
 8   second_in       5186 non-null   float64
 9   second_won      5186 non-null   float64
 10  bk_pts          5186 non-null   float64
 11  bp_saved        5186 non-null   float64
 12  return_pts      5186 non-null   float64
 13  return_pts_won  5186 non-null   float64
 14  winners         5186 non-null   float64
 15  winners_fh      5186 non-null   float64
 16  winners_bh      5186 non-null   float64
 17  unforced        5186 non-null   float64
 18  unforced_fh     5186 non-null   float64
 19  unforced_bh     5186 non-null   float64
 20  returnable      5186 non-null   float64
 21  shallow         5186 non-null   float64
 22  deep            5186 non-null   float64
 23  very_deep       5186 non-null   float64
 24  err_net         5186 non-null   float64
 25  err_deep        5186 non-null   float64
 26  err_wide        5186 non-null   float64
 27  err_wide_deep   5186 non-null   float64
 28  crosscourt      5193 non-null   int64  
 29  down_middle     5193 non-null   int64  
 30  down_the_line   5193 non-null   int64  
 31  inside_out      5193 non-null   int64  
 32  inside_in       5193 non-null   int64  
dtypes: float64(25), int64(6), object(2)
memory usage: 1.3+ MB</code></pre>
</div>
</div>
<p>data after the merge</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>overview_p1 <span class="op">=</span> overview_p2.copy()</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>overview_p2_w <span class="op">=</span> overview_p2.copy()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>overview_p1_w <span class="op">=</span> overview_p2.copy()</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>overview_cl<span class="op">=</span> overview_p2.copy()</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>overview_p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>match_id</th>
      <th>player</th>
      <th>set</th>
      <th>serve_pts</th>
      <th>aces</th>
      <th>dfs</th>
      <th>first_in</th>
      <th>first_won</th>
      <th>second_in</th>
      <th>second_won</th>
      <th>...</th>
      <th>very_deep</th>
      <th>err_net</th>
      <th>err_deep</th>
      <th>err_wide</th>
      <th>err_wide_deep</th>
      <th>crosscourt</th>
      <th>down_middle</th>
      <th>down_the_line</th>
      <th>inside_out</th>
      <th>inside_in</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>19751219-M-Davis_Cup_World_Group_F-RR-Bjorn_Bo...</td>
      <td>1</td>
      <td>Total</td>
      <td>69.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>32.0</td>
      <td>25.0</td>
      <td>37.0</td>
      <td>21.0</td>
      <td>...</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>87</td>
      <td>43</td>
      <td>19</td>
      <td>22</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>19751219-M-Davis_Cup_World_Group_F-RR-Bjorn_Bo...</td>
      <td>2</td>
      <td>Total</td>
      <td>63.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>41.0</td>
      <td>20.0</td>
      <td>22.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>79</td>
      <td>52</td>
      <td>17</td>
      <td>26</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>19780125-M-Pepsi_Grand_Slam-SF-Brian_Gottfried...</td>
      <td>1</td>
      <td>Total</td>
      <td>55.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>32.0</td>
      <td>21.0</td>
      <td>23.0</td>
      <td>9.0</td>
      <td>...</td>
      <td>16.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>88</td>
      <td>33</td>
      <td>20</td>
      <td>13</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>19780125-M-Pepsi_Grand_Slam-SF-Brian_Gottfried...</td>
      <td>2</td>
      <td>Total</td>
      <td>49.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>31.0</td>
      <td>25.0</td>
      <td>18.0</td>
      <td>10.0</td>
      <td>...</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>132</td>
      <td>45</td>
      <td>19</td>
      <td>10</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>19800705-M-Wimbledon-F-John_Mcenroe-Bjorn_Borg</td>
      <td>1</td>
      <td>Total</td>
      <td>180.0</td>
      <td>12.0</td>
      <td>3.0</td>
      <td>111.0</td>
      <td>75.0</td>
      <td>69.0</td>
      <td>44.0</td>
      <td>...</td>
      <td>25.0</td>
      <td>20.0</td>
      <td>11.0</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>43</td>
      <td>25</td>
      <td>40</td>
      <td>17</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5244</th>
      <td>20220712-M-Bastad-R32-Emil_Ruusuvuori-Dominic_...</td>
      <td>2</td>
      <td>Total</td>
      <td>98.0</td>
      <td>7.0</td>
      <td>3.0</td>
      <td>69.0</td>
      <td>45.0</td>
      <td>29.0</td>
      <td>14.0</td>
      <td>...</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>141</td>
      <td>102</td>
      <td>25</td>
      <td>46</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5245</th>
      <td>20220706-M-Wimbledon-QF-Nick_Kyrgios-Cristian_...</td>
      <td>1</td>
      <td>Total</td>
      <td>114.0</td>
      <td>17.0</td>
      <td>4.0</td>
      <td>81.0</td>
      <td>59.0</td>
      <td>33.0</td>
      <td>14.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>44</td>
      <td>99</td>
      <td>14</td>
      <td>34</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5246</th>
      <td>20220706-M-Wimbledon-QF-Nick_Kyrgios-Cristian_...</td>
      <td>2</td>
      <td>Total</td>
      <td>88.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>63.0</td>
      <td>43.0</td>
      <td>25.0</td>
      <td>13.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>66</td>
      <td>94</td>
      <td>4</td>
      <td>27</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5247</th>
      <td>20220713-M-Newport-R16-Andy_Murray-Max_Purcell</td>
      <td>1</td>
      <td>Total</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>5.0</td>
      <td>50.0</td>
      <td>35.0</td>
      <td>37.0</td>
      <td>16.0</td>
      <td>...</td>
      <td>15.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>131</td>
      <td>60</td>
      <td>35</td>
      <td>39</td>
      <td>7</td>
    </tr>
    <tr>
      <th>5248</th>
      <td>20220713-M-Newport-R16-Andy_Murray-Max_Purcell</td>
      <td>2</td>
      <td>Total</td>
      <td>80.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>45.0</td>
      <td>22.0</td>
      <td>35.0</td>
      <td>14.0</td>
      <td>...</td>
      <td>22.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>118</td>
      <td>45</td>
      <td>31</td>
      <td>23</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5193 rows × 33 columns</p>
</div>
</div>
</div>
<p>the data from the first repo</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>first_repo_data <span class="op">=</span> pd.read_csv(<span class="st">'../data/atp_matches_2005-2022.csv'</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>first_repo_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/conda/lib/python3.9/site-packages/IPython/core/interactiveshell.py:3444: DtypeWarning:

Columns (9,17) have mixed types.Specify dtype option on import or set low_memory=False.
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unnamed: 0</th>
      <th>tourney_id</th>
      <th>tourney_name</th>
      <th>surface</th>
      <th>draw_size</th>
      <th>tourney_level</th>
      <th>tourney_date</th>
      <th>match_num</th>
      <th>winner_id</th>
      <th>winner_seed</th>
      <th>...</th>
      <th>l_1stIn</th>
      <th>l_1stWon</th>
      <th>l_2ndWon</th>
      <th>l_SvGms</th>
      <th>l_bpSaved</th>
      <th>l_bpFaced</th>
      <th>winner_rank</th>
      <th>winner_rank_points</th>
      <th>loser_rank</th>
      <th>loser_rank_points</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2005-1536</td>
      <td>Madrid Masters</td>
      <td>Hard</td>
      <td>48</td>
      <td>M</td>
      <td>20051017</td>
      <td>1</td>
      <td>103812</td>
      <td>NaN</td>
      <td>...</td>
      <td>27.0</td>
      <td>20.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>42.0</td>
      <td>827.0</td>
      <td>63.0</td>
      <td>621.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2005-1536</td>
      <td>Madrid Masters</td>
      <td>Hard</td>
      <td>48</td>
      <td>M</td>
      <td>20051017</td>
      <td>2</td>
      <td>102845</td>
      <td>NaN</td>
      <td>...</td>
      <td>24.0</td>
      <td>16.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>9.0</td>
      <td>33.0</td>
      <td>1005.0</td>
      <td>41.0</td>
      <td>836.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2005-1536</td>
      <td>Madrid Masters</td>
      <td>Hard</td>
      <td>48</td>
      <td>M</td>
      <td>20051017</td>
      <td>3</td>
      <td>102450</td>
      <td>NaN</td>
      <td>...</td>
      <td>22.0</td>
      <td>15.0</td>
      <td>20.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>26.0</td>
      <td>1120.0</td>
      <td>28.0</td>
      <td>1115.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2005-1536</td>
      <td>Madrid Masters</td>
      <td>Hard</td>
      <td>48</td>
      <td>M</td>
      <td>20051017</td>
      <td>4</td>
      <td>104076</td>
      <td>NaN</td>
      <td>...</td>
      <td>32.0</td>
      <td>22.0</td>
      <td>25.0</td>
      <td>12.0</td>
      <td>4.0</td>
      <td>8.0</td>
      <td>55.0</td>
      <td>678.0</td>
      <td>29.0</td>
      <td>1090.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>2005-1536</td>
      <td>Madrid Masters</td>
      <td>Hard</td>
      <td>48</td>
      <td>M</td>
      <td>20051017</td>
      <td>5</td>
      <td>103971</td>
      <td>NaN</td>
      <td>...</td>
      <td>21.0</td>
      <td>13.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>45.0</td>
      <td>771.0</td>
      <td>30.0</td>
      <td>1070.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 50 columns</p>
</div>
</div>
</div>
<p>One important thing here is that as we see the players information in the second repo are on diffrent rows whereas on the first they are in one row. Another problem is that in the first repo we have the winner info and the loser info denoted by w &amp; l. Therefore we have to match player 1 &amp; 2 names into winner_name and loser_name and the same for the rest. Since sometime player1 is the winner and sometime player2 is the winner I solve this issue by creating two datasets. The first one is where the first player is the winner and add a new column ‘Label’ with a value of 1. The second dataset if player2 is the winner with a label of value 0</p>
<p>The columns that I will add from the second repo datasets: The overview dataset : [‘winners_fh’,‘winners_bh’,‘unforced_fh’,‘unforced_bh’,‘return_pts’,‘return_pts_won’]</p>
<p>The data cleaning proccess for the second repo datasets is the same for each dataset : split the match_id to get the players names and rename other fetures to merge the datasets based on the names and the common fetures such as aces (This is because some players can play againest each other multiple times)</p>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>overview_p2[[<span class="st">'tourney_date'</span>, <span class="st">'sm'</span>, <span class="st">'tourney_name'</span>, <span class="st">'sm2'</span>, <span class="st">'player1'</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>             <span class="st">'player2'</span>]] <span class="op">=</span> overview_p2[<span class="st">'match_id'</span>].<span class="bu">str</span>.split(<span class="st">'-'</span>, <span class="dv">6</span>, expand<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'tourney_date'</span>] <span class="op">=</span> overview_p2[<span class="st">'tourney_date'</span>].<span class="bu">apply</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> x: <span class="bu">int</span>(x))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>overview_p2 <span class="op">=</span> overview_p2.loc[overview_p2[<span class="st">'tourney_date'</span>] <span class="op">&gt;</span> <span class="dv">20000000</span>, :]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>overview_p2 <span class="op">=</span> overview_p2[(overview_p2[<span class="st">'player'</span>] <span class="op">==</span> <span class="dv">2</span>)]</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_1stIn'</span>] <span class="op">=</span> overview_p2[<span class="st">'first_in'</span>]</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_1stWon'</span>] <span class="op">=</span> overview_p2[<span class="st">'first_won'</span>]</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_2ndWon'</span>] <span class="op">=</span> overview_p2[<span class="st">'second_won'</span>]</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_ace'</span>] <span class="op">=</span> overview_p2[<span class="st">'aces'</span>]</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_winners_fh'</span>] <span class="op">=</span> overview_p2[<span class="st">'winners_fh'</span>]</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_winners_bh'</span>] <span class="op">=</span> overview_p2[<span class="st">'winners_bh'</span>]</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_unforced_fh'</span>] <span class="op">=</span> overview_p2[<span class="st">'unforced_fh'</span>]</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_unforced_bh'</span>] <span class="op">=</span> overview_p2[<span class="st">'unforced_bh'</span>]</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_return_pts_faced'</span>] <span class="op">=</span> overview_p2[<span class="st">'return_pts'</span>]</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_return_pts_won'</span>] <span class="op">=</span> overview_p2[<span class="st">'return_pts_won'</span>]</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_return_depth_very_deep'</span>] <span class="op">=</span> overview_p2[<span class="st">'very_deep'</span>]</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_return_depth_shallow'</span>] <span class="op">=</span> overview_p2[<span class="st">'shallow'</span>]</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_return_depth_deep'</span>] <span class="op">=</span> overview_p2[<span class="st">'deep'</span>]</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_return_depth_err_net'</span>] <span class="op">=</span> overview_p2[<span class="st">'err_net'</span>]</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_return_depth_err_deep'</span>] <span class="op">=</span> overview_p2[<span class="st">'err_deep'</span>]</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_return_depth_err_wide'</span>] <span class="op">=</span> overview_p2[<span class="st">'err_wide'</span>]</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_return_depth_wide_deep'</span>] <span class="op">=</span> overview_p2[<span class="st">'err_wide_deep'</span>]</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_shot_Direction_crosscourt'</span>] <span class="op">=</span> overview_p2[<span class="st">'crosscourt'</span>]</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_shot_Direction_down_middle'</span>] <span class="op">=</span> overview_p2[<span class="st">'down_middle'</span>]</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_shot_Direction_down_the_line'</span>] <span class="op">=</span> overview_p2[<span class="st">'down_the_line'</span>]</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_shot_Direction_inside_out'</span>] <span class="op">=</span> overview_p2[<span class="st">'inside_out'</span>]</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>overview_p2[<span class="st">'l_shot_Direction_inside_in'</span>] <span class="op">=</span> overview_p2[<span class="st">'inside_in'</span>]</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>overview_p2.drop(overview_p2.columns.to_list()[<span class="dv">1</span>:<span class="dv">37</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>overview_p2.rename(columns<span class="op">=</span>{<span class="st">'player1'</span>: <span class="st">'winner_name'</span>,</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'player2'</span>: <span class="st">'loser_name'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>overview_p2.loc[:, [<span class="st">'winner_name'</span>, <span class="st">'loser_name'</span>]] <span class="op">=</span> overview_p2.loc[:, [</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">'winner_name'</span>, <span class="st">'loser_name'</span>]].applymap(<span class="kw">lambda</span> x: x.replace(<span class="st">'_'</span>, <span class="st">' '</span>))  <span class="co"># for multiple columns</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(overview_p2.columns.tolist())</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(overview_p2.info())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>['match_id', 'winner_name', 'loser_name', 'l_1stIn', 'l_1stWon', 'l_2ndWon', 'l_ace', 'l_winners_fh', 'l_winners_bh', 'l_unforced_fh', 'l_unforced_bh', 'l_return_pts_faced', 'l_return_pts_won', 'l_return_depth_very_deep', 'l_return_depth_shallow', 'l_return_depth_deep', 'l_return_depth_err_net', 'l_return_depth_err_deep', 'l_return_depth_err_wide', 'l_return_depth_wide_deep', 'l_shot_Direction_crosscourt', 'l_shot_Direction_down_middle', 'l_shot_Direction_down_the_line', 'l_shot_Direction_inside_out', 'l_shot_Direction_inside_in']
&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 2257 entries, 99 to 5248
Data columns (total 25 columns):
 #   Column                          Non-Null Count  Dtype  
---  ------                          --------------  -----  
 0   match_id                        2257 non-null   object 
 1   winner_name                     2257 non-null   object 
 2   loser_name                      2257 non-null   object 
 3   l_1stIn                         2254 non-null   float64
 4   l_1stWon                        2254 non-null   float64
 5   l_2ndWon                        2254 non-null   float64
 6   l_ace                           2254 non-null   float64
 7   l_winners_fh                    2254 non-null   float64
 8   l_winners_bh                    2254 non-null   float64
 9   l_unforced_fh                   2254 non-null   float64
 10  l_unforced_bh                   2254 non-null   float64
 11  l_return_pts_faced              2254 non-null   float64
 12  l_return_pts_won                2254 non-null   float64
 13  l_return_depth_very_deep        2254 non-null   float64
 14  l_return_depth_shallow          2254 non-null   float64
 15  l_return_depth_deep             2254 non-null   float64
 16  l_return_depth_err_net          2254 non-null   float64
 17  l_return_depth_err_deep         2254 non-null   float64
 18  l_return_depth_err_wide         2254 non-null   float64
 19  l_return_depth_wide_deep        2254 non-null   float64
 20  l_shot_Direction_crosscourt     2257 non-null   int64  
 21  l_shot_Direction_down_middle    2257 non-null   int64  
 22  l_shot_Direction_down_the_line  2257 non-null   int64  
 23  l_shot_Direction_inside_out     2257 non-null   int64  
 24  l_shot_Direction_inside_in      2257 non-null   int64  
dtypes: float64(17), int64(5), object(3)
memory usage: 458.5+ KB
None</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>overview_p1[[<span class="st">'tourney_date'</span>, <span class="st">'sm'</span>, <span class="st">'tourney_name'</span>, <span class="st">'sm2'</span>, <span class="st">'player1'</span>,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>             <span class="st">'player2'</span>]] <span class="op">=</span> overview_p1[<span class="st">'match_id'</span>].<span class="bu">str</span>.split(<span class="st">'-'</span>, <span class="dv">6</span>, expand<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df.rename(columns = {'first_in':'l_1stIn', 'first_won':'l_1stWon','second_won' : 'l_2ndWon', 'aces' : 'l_ace'}, inplace = True)</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'tourney_date'</span>] <span class="op">=</span> overview_p1[<span class="st">'tourney_date'</span>].<span class="bu">apply</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> x: <span class="bu">int</span>(x))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>overview_p1 <span class="op">=</span> overview_p1.loc[overview_p1[<span class="st">'tourney_date'</span>] <span class="op">&gt;</span> <span class="dv">20000000</span>, :]</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>overview_p1 <span class="op">=</span> overview_p1[(overview_p1[<span class="st">'set'</span>] <span class="op">==</span> <span class="st">'Total'</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                          <span class="op">&amp;</span> (overview_p1[<span class="st">'player'</span>] <span class="op">==</span> <span class="dv">1</span>)]</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># df[df['l_1stIn' , 'l_1stWon','l_2ndWon' , 'l_ace']] = df['first_in', 'first_won','second_won' , 'aces' ]</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_1stIn'</span>] <span class="op">=</span> overview_p1[<span class="st">'first_in'</span>]</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_1stWon'</span>] <span class="op">=</span> overview_p1[<span class="st">'first_won'</span>]</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_2ndWon'</span>] <span class="op">=</span> overview_p1[<span class="st">'second_won'</span>]</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_ace'</span>] <span class="op">=</span> overview_p1[<span class="st">'aces'</span>]</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_winners_fh'</span>] <span class="op">=</span> overview_p1[<span class="st">'winners_fh'</span>]</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_winners_bh'</span>] <span class="op">=</span> overview_p1[<span class="st">'winners_bh'</span>]</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_unforced_fh'</span>] <span class="op">=</span> overview_p1[<span class="st">'unforced_fh'</span>]</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_unforced_bh'</span>] <span class="op">=</span> overview_p1[<span class="st">'unforced_bh'</span>]</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_return_pts_faced'</span>] <span class="op">=</span> overview_p1[<span class="st">'return_pts'</span>]</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_return_pts_won'</span>] <span class="op">=</span> overview_p1[<span class="st">'return_pts_won'</span>]</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_return_depth_very_deep'</span>] <span class="op">=</span> overview_p1[<span class="st">'very_deep'</span>]</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_return_depth_shallow'</span>] <span class="op">=</span> overview_p1[<span class="st">'shallow'</span>]</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_return_depth_deep'</span>] <span class="op">=</span> overview_p1[<span class="st">'deep'</span>]</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_return_depth_err_net'</span>] <span class="op">=</span> overview_p1[<span class="st">'err_net'</span>]</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_return_depth_err_deep'</span>] <span class="op">=</span> overview_p1[<span class="st">'err_deep'</span>]</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_return_depth_err_wide'</span>] <span class="op">=</span> overview_p1[<span class="st">'err_wide'</span>]</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_return_depth_wide_deep'</span>] <span class="op">=</span> overview_p1[<span class="st">'err_wide_deep'</span>]</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_shot_Direction_crosscourt'</span>] <span class="op">=</span> overview_p1[<span class="st">'crosscourt'</span>]</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_shot_Direction_down_middle'</span>] <span class="op">=</span> overview_p1[<span class="st">'down_middle'</span>]</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_shot_Direction_down_the_line'</span>] <span class="op">=</span> overview_p1[<span class="st">'down_the_line'</span>]</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_shot_Direction_inside_out'</span>] <span class="op">=</span> overview_p1[<span class="st">'inside_out'</span>]</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>overview_p1[<span class="st">'w_shot_Direction_inside_in'</span>] <span class="op">=</span> overview_p1[<span class="st">'inside_in'</span>]</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>overview_p1.drop(overview_p1.columns.to_list()[<span class="dv">1</span>:<span class="dv">37</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>overview_p1.rename(columns<span class="op">=</span>{<span class="st">'player1'</span>: <span class="st">'winner_name'</span>,</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'player2'</span>: <span class="st">'loser_name'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>overview_p1.loc[:, [<span class="st">'winner_name'</span>, <span class="st">'loser_name'</span>]] <span class="op">=</span> overview_p1.loc[:, [</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">'winner_name'</span>, <span class="st">'loser_name'</span>]].applymap(<span class="kw">lambda</span> x: x.replace(<span class="st">'_'</span>, <span class="st">' '</span>))  <span class="co"># for multiple columns</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>overview_p1</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(overview_p1.columns.tolist())</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(overview_p1.info())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>['match_id', 'winner_name', 'loser_name', 'w_1stIn', 'w_1stWon', 'w_2ndWon', 'w_ace', 'w_winners_fh', 'w_winners_bh', 'w_unforced_fh', 'w_unforced_bh', 'w_return_pts_faced', 'w_return_pts_won', 'w_return_depth_very_deep', 'w_return_depth_shallow', 'w_return_depth_deep', 'w_return_depth_err_net', 'w_return_depth_err_deep', 'w_return_depth_err_wide', 'w_return_depth_wide_deep', 'w_shot_Direction_crosscourt', 'w_shot_Direction_down_middle', 'w_shot_Direction_down_the_line', 'w_shot_Direction_inside_out', 'w_shot_Direction_inside_in']</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 2258 entries, 98 to 5247
Data columns (total 25 columns):
 #   Column                          Non-Null Count  Dtype  
---  ------                          --------------  -----  
 0   match_id                        2258 non-null   object 
 1   winner_name                     2258 non-null   object 
 2   loser_name                      2258 non-null   object 
 3   w_1stIn                         2254 non-null   float64
 4   w_1stWon                        2254 non-null   float64
 5   w_2ndWon                        2254 non-null   float64
 6   w_ace                           2254 non-null   float64
 7   w_winners_fh                    2254 non-null   float64
 8   w_winners_bh                    2254 non-null   float64
 9   w_unforced_fh                   2254 non-null   float64
 10  w_unforced_bh                   2254 non-null   float64
 11  w_return_pts_faced              2254 non-null   float64
 12  w_return_pts_won                2254 non-null   float64
 13  w_return_depth_very_deep        2254 non-null   float64
 14  w_return_depth_shallow          2254 non-null   float64
 15  w_return_depth_deep             2254 non-null   float64
 16  w_return_depth_err_net          2254 non-null   float64
 17  w_return_depth_err_deep         2254 non-null   float64
 18  w_return_depth_err_wide         2254 non-null   float64
 19  w_return_depth_wide_deep        2254 non-null   float64
 20  w_shot_Direction_crosscourt     2258 non-null   int64  
 21  w_shot_Direction_down_middle    2258 non-null   int64  
 22  w_shot_Direction_down_the_line  2258 non-null   int64  
 23  w_shot_Direction_inside_out     2258 non-null   int64  
 24  w_shot_Direction_inside_in      2258 non-null   int64  
dtypes: float64(17), int64(5), object(3)
memory usage: 458.7+ KB
None</code></pre>
</div>
</div>
<p>merge the first repo with the second repo and create label with a value of 1 that indicates that the first player is the winner</p>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>overview_clean <span class="op">=</span> pd.merge(overview_p1,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                          overview_p2,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                          on<span class="op">=</span>[<span class="st">'winner_name'</span>, <span class="st">'loser_name'</span>, <span class="st">'match_id'</span>],</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                          how<span class="op">=</span><span class="st">"outer"</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>player1_merged <span class="op">=</span> pd.merge(first_repo_data,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                          overview_clean,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                          on<span class="op">=</span>[<span class="st">'l_1stIn'</span>, <span class="st">'l_1stWon'</span>, <span class="st">'l_2ndWon'</span>, <span class="st">'l_ace'</span>, <span class="st">'winner_name'</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                              <span class="st">'loser_name'</span>, <span class="st">'w_1stIn'</span>, <span class="st">'w_1stWon'</span>, <span class="st">'w_2ndWon'</span>, <span class="st">'w_ace'</span>],</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>                          how<span class="op">=</span><span class="st">"right"</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co"># player1_merged = player1_merged.dropna(subset=['l_bpSaved'])</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>player1_merged.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># first player wins so label=1</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>winner_player1 <span class="op">=</span> np.ones(player1_merged.shape[<span class="dv">0</span>])</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>player1_merged[<span class="st">'label'</span>] <span class="op">=</span> winner_player1</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># print(player1_merged.info())</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co"># display(player1_merged.head())</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(player1_merged.info())</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>player1_merged.to_csv(<span class="st">'../data/first-ATP.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 2258 entries, 0 to 2257
Data columns (total 89 columns):
 #   Column                          Non-Null Count  Dtype  
---  ------                          --------------  -----  
 0   index                           2258 non-null   int64  
 1   Unnamed: 0                      323 non-null    float64
 2   tourney_id                      323 non-null    object 
 3   tourney_name                    323 non-null    object 
 4   surface                         323 non-null    object 
 5   draw_size                       323 non-null    float64
 6   tourney_level                   323 non-null    object 
 7   tourney_date                    323 non-null    float64
 8   match_num                       323 non-null    float64
 9   winner_id                       323 non-null    float64
 10  winner_seed                     227 non-null    object 
 11  winner_entry                    27 non-null     object 
 12  winner_name                     2258 non-null   object 
 13  winner_hand                     323 non-null    object 
 14  winner_ht                       323 non-null    float64
 15  winner_ioc                      323 non-null    object 
 16  winner_age                      323 non-null    float64
 17  loser_id                        323 non-null    float64
 18  loser_seed                      156 non-null    object 
 19  loser_entry                     43 non-null     object 
 20  loser_name                      2258 non-null   object 
 21  loser_hand                      323 non-null    object 
 22  loser_ht                        320 non-null    float64
 23  loser_ioc                       323 non-null    object 
 24  loser_age                       323 non-null    float64
 25  score                           323 non-null    object 
 26  best_of                         323 non-null    float64
 27  round                           323 non-null    object 
 28  minutes                         304 non-null    float64
 29  w_ace                           2254 non-null   float64
 30  w_df                            322 non-null    float64
 31  w_svpt                          322 non-null    float64
 32  w_1stIn                         2254 non-null   float64
 33  w_1stWon                        2254 non-null   float64
 34  w_2ndWon                        2254 non-null   float64
 35  w_SvGms                         322 non-null    float64
 36  w_bpSaved                       322 non-null    float64
 37  w_bpFaced                       322 non-null    float64
 38  l_ace                           2254 non-null   float64
 39  l_df                            322 non-null    float64
 40  l_svpt                          322 non-null    float64
 41  l_1stIn                         2254 non-null   float64
 42  l_1stWon                        2254 non-null   float64
 43  l_2ndWon                        2254 non-null   float64
 44  l_SvGms                         322 non-null    float64
 45  l_bpSaved                       322 non-null    float64
 46  l_bpFaced                       322 non-null    float64
 47  winner_rank                     323 non-null    float64
 48  winner_rank_points              323 non-null    float64
 49  loser_rank                      323 non-null    float64
 50  loser_rank_points               323 non-null    float64
 51  match_id                        2258 non-null   object 
 52  w_winners_fh                    2254 non-null   float64
 53  w_winners_bh                    2254 non-null   float64
 54  w_unforced_fh                   2254 non-null   float64
 55  w_unforced_bh                   2254 non-null   float64
 56  w_return_pts_faced              2254 non-null   float64
 57  w_return_pts_won                2254 non-null   float64
 58  w_return_depth_very_deep        2254 non-null   float64
 59  w_return_depth_shallow          2254 non-null   float64
 60  w_return_depth_deep             2254 non-null   float64
 61  w_return_depth_err_net          2254 non-null   float64
 62  w_return_depth_err_deep         2254 non-null   float64
 63  w_return_depth_err_wide         2254 non-null   float64
 64  w_return_depth_wide_deep        2254 non-null   float64
 65  w_shot_Direction_crosscourt     2258 non-null   int64  
 66  w_shot_Direction_down_middle    2258 non-null   int64  
 67  w_shot_Direction_down_the_line  2258 non-null   int64  
 68  w_shot_Direction_inside_out     2258 non-null   int64  
 69  w_shot_Direction_inside_in      2258 non-null   int64  
 70  l_winners_fh                    2254 non-null   float64
 71  l_winners_bh                    2254 non-null   float64
 72  l_unforced_fh                   2254 non-null   float64
 73  l_unforced_bh                   2254 non-null   float64
 74  l_return_pts_faced              2254 non-null   float64
 75  l_return_pts_won                2254 non-null   float64
 76  l_return_depth_very_deep        2254 non-null   float64
 77  l_return_depth_shallow          2254 non-null   float64
 78  l_return_depth_deep             2254 non-null   float64
 79  l_return_depth_err_net          2254 non-null   float64
 80  l_return_depth_err_deep         2254 non-null   float64
 81  l_return_depth_err_wide         2254 non-null   float64
 82  l_return_depth_wide_deep        2254 non-null   float64
 83  l_shot_Direction_crosscourt     2257 non-null   float64
 84  l_shot_Direction_down_middle    2257 non-null   float64
 85  l_shot_Direction_down_the_line  2257 non-null   float64
 86  l_shot_Direction_inside_out     2257 non-null   float64
 87  l_shot_Direction_inside_in      2257 non-null   float64
 88  label                           2258 non-null   float64
dtypes: float64(66), int64(6), object(17)
memory usage: 1.5+ MB
None</code></pre>
</div>
</div>
<p>The same thing like above but here the second player is the winner so the ‘label’ will be 0</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>overview_p2_w[[<span class="st">'tourney_date'</span>, <span class="st">'sm'</span>, <span class="st">'tourney_name'</span>, <span class="st">'sm2'</span>, <span class="st">'player1'</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">'player2'</span>]] <span class="op">=</span> overview_p2_w[<span class="st">'match_id'</span>].<span class="bu">str</span>.split(<span class="st">'-'</span>, <span class="dv">6</span>, expand<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'tourney_date'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'tourney_date'</span>].<span class="bu">apply</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> x: <span class="bu">int</span>(x))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>overview_p2_w <span class="op">=</span> overview_p2_w.loc[overview_p2_w[<span class="st">'tourney_date'</span>] <span class="op">&gt;</span> <span class="dv">20000000</span>, :]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>overview_p2_w <span class="op">=</span> overview_p2_w[(overview_p2_w[<span class="st">'set'</span>] <span class="op">==</span> <span class="st">'Total'</span>) <span class="op">&amp;</span> (</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    overview_p2_w[<span class="st">'player'</span>] <span class="op">==</span> <span class="dv">1</span>)]</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_1stIn'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'first_in'</span>]</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_1stWon'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'first_won'</span>]</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_2ndWon'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'second_won'</span>]</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_ace'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'aces'</span>]</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_winners_fh'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'winners_fh'</span>]</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_winners_bh'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'winners_bh'</span>]</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_unforced_fh'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'unforced_fh'</span>]</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_unforced_bh'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'unforced_bh'</span>]</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_return_pts_faced'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'return_pts'</span>]</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_return_pts_won'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'return_pts_won'</span>]</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_return_depth_very_deep'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'very_deep'</span>]</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_return_depth_shallow'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'shallow'</span>]</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_return_depth_deep'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'deep'</span>]</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_return_depth_err_net'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'err_net'</span>]</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_return_depth_err_deep'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'err_deep'</span>]</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_return_depth_err_wide'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'err_wide'</span>]</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_return_depth_wide_deep'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'err_wide_deep'</span>]</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_shot_Direction_crosscourt'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'crosscourt'</span>]</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_shot_Direction_down_middle'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'down_middle'</span>]</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_shot_Direction_down_the_line'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'down_the_line'</span>]</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_shot_Direction_inside_out'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'inside_out'</span>]</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>overview_p2_w[<span class="st">'l_shot_Direction_inside_in'</span>] <span class="op">=</span> overview_p2_w[<span class="st">'inside_in'</span>]</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>overview_p2_w.drop(overview_p2_w.columns.to_list()[<span class="dv">1</span>:<span class="dv">37</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>overview_p2_w.rename(</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>{<span class="st">'player1'</span>: <span class="st">'loser_name'</span>, <span class="st">'player2'</span>: <span class="st">'winner_name'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>overview_p2_w.loc[:, [<span class="st">'winner_name'</span>, <span class="st">'loser_name'</span>]] <span class="op">=</span> overview_p2_w.loc[:, [</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">'winner_name'</span>, <span class="st">'loser_name'</span>]].applymap(<span class="kw">lambda</span> x: x.replace(<span class="st">'_'</span>, <span class="st">' '</span>))  <span class="co"># for multiple columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>overview_p2_w.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="14">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>match_id</th>
      <th>loser_name</th>
      <th>winner_name</th>
      <th>l_1stIn</th>
      <th>l_1stWon</th>
      <th>l_2ndWon</th>
      <th>l_ace</th>
      <th>l_winners_fh</th>
      <th>l_winners_bh</th>
      <th>l_unforced_fh</th>
      <th>...</th>
      <th>l_return_depth_deep</th>
      <th>l_return_depth_err_net</th>
      <th>l_return_depth_err_deep</th>
      <th>l_return_depth_err_wide</th>
      <th>l_return_depth_wide_deep</th>
      <th>l_shot_Direction_crosscourt</th>
      <th>l_shot_Direction_down_middle</th>
      <th>l_shot_Direction_down_the_line</th>
      <th>l_shot_Direction_inside_out</th>
      <th>l_shot_Direction_inside_in</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>98</th>
      <td>20000612-M-Queens_Club-QF-Bob_Bryan-Pete_Sampras</td>
      <td>Bob Bryan</td>
      <td>Pete Sampras</td>
      <td>40.0</td>
      <td>27.0</td>
      <td>13.0</td>
      <td>9.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8</td>
      <td>9</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>100</th>
      <td>20000910-M-US_Open-F-Pete_Sampras-Marat_Safin</td>
      <td>Pete Sampras</td>
      <td>Marat Safin</td>
      <td>51.0</td>
      <td>38.0</td>
      <td>11.0</td>
      <td>8.0</td>
      <td>12.0</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>...</td>
      <td>48.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>54</td>
      <td>27</td>
      <td>8</td>
      <td>8</td>
      <td>6</td>
    </tr>
    <tr>
      <th>102</th>
      <td>20001127-M-Tour_Finals-SF-Marat_Safin-Andre_Ag...</td>
      <td>Marat Safin</td>
      <td>Andre Agassi</td>
      <td>34.0</td>
      <td>22.0</td>
      <td>13.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>13.0</td>
      <td>14.0</td>
      <td>...</td>
      <td>40.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>106</td>
      <td>45</td>
      <td>34</td>
      <td>8</td>
      <td>1</td>
    </tr>
    <tr>
      <th>104</th>
      <td>20010312-M-Indian_Wells-QF-Nicolas_Lapentti-An...</td>
      <td>Nicolas Lapentti</td>
      <td>Andre Agassi</td>
      <td>18.0</td>
      <td>9.0</td>
      <td>9.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>46</td>
      <td>47</td>
      <td>18</td>
      <td>20</td>
      <td>5</td>
    </tr>
    <tr>
      <th>106</th>
      <td>20010319-M-Miami_Masters-R32-Pete_Sampras-Andy...</td>
      <td>Pete Sampras</td>
      <td>Andy Roddick</td>
      <td>42.0</td>
      <td>30.0</td>
      <td>11.0</td>
      <td>8.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>...</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>22</td>
      <td>5</td>
      <td>9</td>
      <td>8</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 25 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>overview_p1_w[[<span class="st">'tourney_date'</span>, <span class="st">'sm'</span>, <span class="st">'tourney_name'</span>, <span class="st">'sm2'</span>, <span class="st">'player1'</span>,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">'player2'</span>]] <span class="op">=</span> overview_p1_w[<span class="st">'match_id'</span>].<span class="bu">str</span>.split(<span class="st">'-'</span>, <span class="dv">6</span>, expand<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df.rename(columns = {'first_in':'l_1stIn', 'first_won':'l_1stWon','second_won' : 'l_2ndWon', 'aces' : 'l_ace'}, inplace = True)</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'tourney_date'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'tourney_date'</span>].<span class="bu">apply</span>(</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> x: <span class="bu">int</span>(x))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>overview_p1_w <span class="op">=</span> overview_p1_w.loc[overview_p1_w[<span class="st">'tourney_date'</span>] <span class="op">&gt;</span> <span class="dv">20000000</span>, :]</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>overview_p1_w <span class="op">=</span> overview_p1_w[(overview_p1_w[<span class="st">'set'</span>] <span class="op">==</span> <span class="st">'Total'</span>) <span class="op">&amp;</span> (</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    overview_p1_w[<span class="st">'player'</span>] <span class="op">==</span> <span class="dv">2</span>)]</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># df[df['l_1stIn' , 'l_1stWon','l_2ndWon' , 'l_ace']] = df['first_in', 'first_won','second_won' , 'aces' ]</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_1stIn'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'first_in'</span>]</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_1stWon'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'first_won'</span>]</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_2ndWon'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'second_won'</span>]</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_ace'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'aces'</span>]</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_winners_fh'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'winners_fh'</span>]</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_winners_bh'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'winners_bh'</span>]</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_unforced_fh'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'unforced_fh'</span>]</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_unforced_bh'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'unforced_bh'</span>]</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_return_pts_faced'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'return_pts'</span>]</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_return_pts_won'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'return_pts_won'</span>]</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_return_depth_very_deep'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'very_deep'</span>]</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_return_depth_shallow'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'shallow'</span>]</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_return_depth_deep'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'deep'</span>]</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_return_depth_err_net'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'err_net'</span>]</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_return_depth_err_deep'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'err_deep'</span>]</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_return_depth_err_wide'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'err_wide'</span>]</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_return_depth_wide_deep'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'err_wide_deep'</span>]</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_shot_Direction_crosscourt'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'crosscourt'</span>]</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_shot_Direction_down_middle'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'down_middle'</span>]</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_shot_Direction_down_the_line'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'down_the_line'</span>]</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_shot_Direction_inside_out'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'inside_out'</span>]</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>overview_p1_w[<span class="st">'w_shot_Direction_inside_in'</span>] <span class="op">=</span> overview_p1_w[<span class="st">'inside_in'</span>]</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>overview_p1_w.drop(overview_p1_w.columns.to_list()[<span class="dv">1</span>:<span class="dv">37</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>overview_p1_w.rename(</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>{<span class="st">'player1'</span>: <span class="st">'loser_name'</span>, <span class="st">'player2'</span>: <span class="st">'winner_name'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>overview_p1_w.loc[:, [<span class="st">'winner_name'</span>, <span class="st">'loser_name'</span>]] <span class="op">=</span> overview_p1_w.loc[:, [</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">'winner_name'</span>, <span class="st">'loser_name'</span>]].applymap(<span class="kw">lambda</span> x: x.replace(<span class="st">'_'</span>, <span class="st">' '</span>))  <span class="co"># for multiple columns</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>overview_p1_w.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="15">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>match_id</th>
      <th>loser_name</th>
      <th>winner_name</th>
      <th>w_1stIn</th>
      <th>w_1stWon</th>
      <th>w_2ndWon</th>
      <th>w_ace</th>
      <th>w_winners_fh</th>
      <th>w_winners_bh</th>
      <th>w_unforced_fh</th>
      <th>...</th>
      <th>w_return_depth_deep</th>
      <th>w_return_depth_err_net</th>
      <th>w_return_depth_err_deep</th>
      <th>w_return_depth_err_wide</th>
      <th>w_return_depth_wide_deep</th>
      <th>w_shot_Direction_crosscourt</th>
      <th>w_shot_Direction_down_middle</th>
      <th>w_shot_Direction_down_the_line</th>
      <th>w_shot_Direction_inside_out</th>
      <th>w_shot_Direction_inside_in</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>99</th>
      <td>20000612-M-Queens_Club-QF-Bob_Bryan-Pete_Sampras</td>
      <td>Bob Bryan</td>
      <td>Pete Sampras</td>
      <td>26.0</td>
      <td>24.0</td>
      <td>14.0</td>
      <td>6.0</td>
      <td>14.0</td>
      <td>18.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>16</td>
      <td>7</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>101</th>
      <td>20000910-M-US_Open-F-Pete_Sampras-Marat_Safin</td>
      <td>Pete Sampras</td>
      <td>Marat Safin</td>
      <td>40.0</td>
      <td>34.0</td>
      <td>26.0</td>
      <td>12.0</td>
      <td>12.0</td>
      <td>13.0</td>
      <td>5.0</td>
      <td>...</td>
      <td>27.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>86</td>
      <td>34</td>
      <td>19</td>
      <td>10</td>
      <td>0</td>
    </tr>
    <tr>
      <th>103</th>
      <td>20001127-M-Tour_Finals-SF-Marat_Safin-Andre_Ag...</td>
      <td>Marat Safin</td>
      <td>Andre Agassi</td>
      <td>38.0</td>
      <td>31.0</td>
      <td>15.0</td>
      <td>5.0</td>
      <td>11.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>34.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>126</td>
      <td>35</td>
      <td>19</td>
      <td>14</td>
      <td>1</td>
    </tr>
    <tr>
      <th>105</th>
      <td>20010312-M-Indian_Wells-QF-Nicolas_Lapentti-An...</td>
      <td>Nicolas Lapentti</td>
      <td>Andre Agassi</td>
      <td>22.0</td>
      <td>18.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>65</td>
      <td>32</td>
      <td>12</td>
      <td>20</td>
      <td>1</td>
    </tr>
    <tr>
      <th>107</th>
      <td>20010319-M-Miami_Masters-R32-Pete_Sampras-Andy...</td>
      <td>Pete Sampras</td>
      <td>Andy Roddick</td>
      <td>40.0</td>
      <td>35.0</td>
      <td>12.0</td>
      <td>7.0</td>
      <td>13.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>26.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>30</td>
      <td>13</td>
      <td>5</td>
      <td>15</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 25 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>overview_clean2 <span class="op">=</span> pd.merge(overview_p1_w,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                           overview_p2_w,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                           on<span class="op">=</span>[<span class="st">'winner_name'</span>, <span class="st">'loser_name'</span>, <span class="st">'match_id'</span>],</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                           how<span class="op">=</span><span class="st">"outer"</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>player2_merged <span class="op">=</span> pd.merge(first_repo_data,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                          overview_clean2,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>                          on<span class="op">=</span>[<span class="st">'l_1stIn'</span>, <span class="st">'l_1stWon'</span>, <span class="st">'l_2ndWon'</span>, <span class="st">'l_ace'</span>, <span class="st">'winner_name'</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>                              <span class="st">'loser_name'</span>, <span class="st">'w_1stIn'</span>, <span class="st">'w_1stWon'</span>, <span class="st">'w_2ndWon'</span>, <span class="st">'w_ace'</span>],</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>                          how<span class="op">=</span><span class="st">"right"</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>player2_merged <span class="op">=</span> player2_merged.dropna(subset<span class="op">=</span>[<span class="st">'l_bpSaved'</span>])</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>player2_merged.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co"># first player wins so label=1</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>winner_player2 <span class="op">=</span> np.zeros(player2_merged.shape[<span class="dv">0</span>])</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>player2_merged[<span class="st">'label'</span>] <span class="op">=</span> winner_player2</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>display(player2_merged.head())</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>display(player2_merged.info())</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>player2_merged.to_csv(<span class="st">'../data/second-ATP.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>index</th>
      <th>Unnamed: 0</th>
      <th>tourney_id</th>
      <th>tourney_name</th>
      <th>surface</th>
      <th>draw_size</th>
      <th>tourney_level</th>
      <th>tourney_date</th>
      <th>match_num</th>
      <th>winner_id</th>
      <th>...</th>
      <th>l_return_depth_err_net</th>
      <th>l_return_depth_err_deep</th>
      <th>l_return_depth_err_wide</th>
      <th>l_return_depth_wide_deep</th>
      <th>l_shot_Direction_crosscourt</th>
      <th>l_shot_Direction_down_middle</th>
      <th>l_shot_Direction_down_the_line</th>
      <th>l_shot_Direction_inside_out</th>
      <th>l_shot_Direction_inside_in</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>32</td>
      <td>7324.0</td>
      <td>2007-352</td>
      <td>Paris Masters</td>
      <td>Hard</td>
      <td>48.0</td>
      <td>M</td>
      <td>20071028.0</td>
      <td>47.0</td>
      <td>103900.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>65</td>
      <td>29</td>
      <td>22</td>
      <td>17</td>
      <td>2</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>56</td>
      <td>17728.0</td>
      <td>2010-540</td>
      <td>Wimbledon</td>
      <td>Grass</td>
      <td>128.0</td>
      <td>G</td>
      <td>20100621.0</td>
      <td>127.0</td>
      <td>104745.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>77</td>
      <td>45</td>
      <td>21</td>
      <td>34</td>
      <td>4</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>62</td>
      <td>19594.0</td>
      <td>2011-495</td>
      <td>Dubai</td>
      <td>Hard</td>
      <td>32.0</td>
      <td>A</td>
      <td>20110221.0</td>
      <td>31.0</td>
      <td>104925.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>55</td>
      <td>34</td>
      <td>15</td>
      <td>30</td>
      <td>3</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>70</td>
      <td>20454.0</td>
      <td>2011-520</td>
      <td>Roland Garros</td>
      <td>Clay</td>
      <td>128.0</td>
      <td>G</td>
      <td>20110522.0</td>
      <td>127.0</td>
      <td>104745.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>163</td>
      <td>104</td>
      <td>56</td>
      <td>63</td>
      <td>8</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>93</td>
      <td>23135.0</td>
      <td>2012-410</td>
      <td>Monte Carlo Masters</td>
      <td>Clay</td>
      <td>56.0</td>
      <td>M</td>
      <td>20120415.0</td>
      <td>55.0</td>
      <td>104745.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>63</td>
      <td>66</td>
      <td>20</td>
      <td>46</td>
      <td>4</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 89 columns</p>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 326 entries, 0 to 325
Data columns (total 89 columns):
 #   Column                          Non-Null Count  Dtype  
---  ------                          --------------  -----  
 0   index                           326 non-null    int64  
 1   Unnamed: 0                      326 non-null    float64
 2   tourney_id                      326 non-null    object 
 3   tourney_name                    326 non-null    object 
 4   surface                         326 non-null    object 
 5   draw_size                       326 non-null    float64
 6   tourney_level                   326 non-null    object 
 7   tourney_date                    326 non-null    float64
 8   match_num                       326 non-null    float64
 9   winner_id                       326 non-null    float64
 10  winner_seed                     209 non-null    object 
 11  winner_entry                    39 non-null     object 
 12  winner_name                     326 non-null    object 
 13  winner_hand                     326 non-null    object 
 14  winner_ht                       325 non-null    float64
 15  winner_ioc                      326 non-null    object 
 16  winner_age                      326 non-null    float64
 17  loser_id                        326 non-null    float64
 18  loser_seed                      184 non-null    object 
 19  loser_entry                     41 non-null     object 
 20  loser_name                      326 non-null    object 
 21  loser_hand                      326 non-null    object 
 22  loser_ht                        323 non-null    float64
 23  loser_ioc                       326 non-null    object 
 24  loser_age                       326 non-null    float64
 25  score                           326 non-null    object 
 26  best_of                         326 non-null    float64
 27  round                           326 non-null    object 
 28  minutes                         319 non-null    float64
 29  w_ace                           326 non-null    float64
 30  w_df                            326 non-null    float64
 31  w_svpt                          326 non-null    float64
 32  w_1stIn                         326 non-null    float64
 33  w_1stWon                        326 non-null    float64
 34  w_2ndWon                        326 non-null    float64
 35  w_SvGms                         326 non-null    float64
 36  w_bpSaved                       326 non-null    float64
 37  w_bpFaced                       326 non-null    float64
 38  l_ace                           326 non-null    float64
 39  l_df                            326 non-null    float64
 40  l_svpt                          326 non-null    float64
 41  l_1stIn                         326 non-null    float64
 42  l_1stWon                        326 non-null    float64
 43  l_2ndWon                        326 non-null    float64
 44  l_SvGms                         326 non-null    float64
 45  l_bpSaved                       326 non-null    float64
 46  l_bpFaced                       326 non-null    float64
 47  winner_rank                     326 non-null    float64
 48  winner_rank_points              326 non-null    float64
 49  loser_rank                      325 non-null    float64
 50  loser_rank_points               325 non-null    float64
 51  match_id                        326 non-null    object 
 52  w_winners_fh                    326 non-null    float64
 53  w_winners_bh                    326 non-null    float64
 54  w_unforced_fh                   326 non-null    float64
 55  w_unforced_bh                   326 non-null    float64
 56  w_return_pts_faced              326 non-null    float64
 57  w_return_pts_won                326 non-null    float64
 58  w_return_depth_very_deep        326 non-null    float64
 59  w_return_depth_shallow          326 non-null    float64
 60  w_return_depth_deep             326 non-null    float64
 61  w_return_depth_err_net          326 non-null    float64
 62  w_return_depth_err_deep         326 non-null    float64
 63  w_return_depth_err_wide         326 non-null    float64
 64  w_return_depth_wide_deep        326 non-null    float64
 65  w_shot_Direction_crosscourt     326 non-null    float64
 66  w_shot_Direction_down_middle    326 non-null    float64
 67  w_shot_Direction_down_the_line  326 non-null    float64
 68  w_shot_Direction_inside_out     326 non-null    float64
 69  w_shot_Direction_inside_in      326 non-null    float64
 70  l_winners_fh                    326 non-null    float64
 71  l_winners_bh                    326 non-null    float64
 72  l_unforced_fh                   326 non-null    float64
 73  l_unforced_bh                   326 non-null    float64
 74  l_return_pts_faced              326 non-null    float64
 75  l_return_pts_won                326 non-null    float64
 76  l_return_depth_very_deep        326 non-null    float64
 77  l_return_depth_shallow          326 non-null    float64
 78  l_return_depth_deep             326 non-null    float64
 79  l_return_depth_err_net          326 non-null    float64
 80  l_return_depth_err_deep         326 non-null    float64
 81  l_return_depth_err_wide         326 non-null    float64
 82  l_return_depth_wide_deep        326 non-null    float64
 83  l_shot_Direction_crosscourt     326 non-null    int64  
 84  l_shot_Direction_down_middle    326 non-null    int64  
 85  l_shot_Direction_down_the_line  326 non-null    int64  
 86  l_shot_Direction_inside_out     326 non-null    int64  
 87  l_shot_Direction_inside_in      326 non-null    int64  
 88  label                           326 non-null    float64
dtypes: float64(66), int64(6), object(17)
memory usage: 226.8+ KB</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>None</code></pre>
</div>
</div>
<p>concat the datasets when the first player is the winner and if the second player to create the full dataset</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>first_ATP <span class="op">=</span> pd.read_csv(<span class="st">'../data/first-ATP.csv'</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>second_ATP <span class="op">=</span> pd.read_csv(<span class="st">'../data/second-ATP.csv'</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>full_data <span class="op">=</span> pd.concat([second_ATP, first_ATP], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>full_data.drop([<span class="st">'Unnamed: 0.1'</span>, <span class="st">'Unnamed: 0'</span>, <span class="st">'index'</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>changing the names for the columns</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>l <span class="op">=</span> full_data.columns.tolist()</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> change(x) : </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x.startswith(<span class="st">'w_'</span>): </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> x[<span class="dv">0</span>:<span class="dv">2</span>]</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> x.replace(i,<span class="st">'fp_'</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> x.startswith(<span class="st">'l_'</span>): </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> x[<span class="dv">0</span>:<span class="dv">2</span>]</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> x.replace(i,<span class="st">'sp_'</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result  </span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> x.startswith(<span class="st">'winner'</span>): </span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> x[<span class="dv">0</span>:<span class="dv">6</span>]</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> x.replace(i,<span class="st">'FirstPlayer'</span>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> x.startswith(<span class="st">'loser_'</span>): </span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> x[<span class="dv">0</span>:<span class="dv">5</span>]</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> x.replace(i,<span class="st">'SecondPlayer_'</span>)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result </span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> : </span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x </span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>full_data.columns <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(change, l))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>null Values</p>
<div class="cell" data-execution_count="18">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>missing_val_count_by_column <span class="op">=</span> (full_data.isnull().<span class="bu">sum</span>())</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(missing_val_count_by_column[missing_val_count_by_column <span class="op">&gt;</span> <span class="dv">0</span>])</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(full_data.SecondPlayer__hand.unique()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tourney_id                         1935
tourney_name                       1935
surface                            1935
draw_size                          1935
tourney_level                      1935
                                   ... 
sp_shot_Direction_crosscourt          1
sp_shot_Direction_down_middle         1
sp_shot_Direction_down_the_line       1
sp_shot_Direction_inside_out          1
sp_shot_Direction_inside_in           1
Length: 78, dtype: int64
['L' 'R' 'U' nan]</code></pre>
</div>
</div>
<p>using imputer to fill the null values</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>full_data <span class="op">=</span> full_data.dropna(subset<span class="op">=</span>[<span class="st">'fp_SvGms'</span>])</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>imputer <span class="op">=</span> KNNImputer(missing_values <span class="op">=</span> np.nan, n_neighbors<span class="op">=</span><span class="dv">5</span>, weights <span class="op">=</span> <span class="st">'distance'</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>full_data[<span class="st">'minutes'</span>] <span class="op">=</span> imputer.fit_transform(full_data[[<span class="st">'minutes'</span>]]).ravel()</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>full_data[<span class="st">'FirstPlayer_ht'</span>] <span class="op">=</span> imputer.fit_transform(full_data[[<span class="st">'FirstPlayer_ht'</span>]]).ravel()</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>full_data[<span class="st">'SecondPlayer__ht'</span>] <span class="op">=</span> imputer.fit_transform(full_data[[<span class="st">'SecondPlayer__ht'</span>]]).ravel()</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>full_data[<span class="st">'SecondPlayer__rank'</span>] <span class="op">=</span> imputer.fit_transform(full_data[[<span class="st">'SecondPlayer__rank'</span>]]).ravel()</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>full_data[<span class="st">'SecondPlayer__rank_points'</span>] <span class="op">=</span> imputer.fit_transform(full_data[[<span class="st">'SecondPlayer__rank_points'</span>]]).ravel()</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>full_data[<span class="st">'SecondPlayer__hand'</span>] <span class="op">=</span> full_data[<span class="st">'SecondPlayer__hand'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x : <span class="st">'R'</span> <span class="cf">if</span> x <span class="op">==</span> <span class="st">"U"</span> <span class="cf">else</span> x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>missing_val_count_by_column <span class="op">=</span> (full_data.isnull().<span class="bu">sum</span>())</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(missing_val_count_by_column[missing_val_count_by_column <span class="op">&gt;</span> <span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>FirstPlayer_seed       212
FirstPlayer_entry      582
SecondPlayer__seed     308
SecondPlayer__entry    564
dtype: int64</code></pre>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>top_data <span class="op">=</span> full_data.loc[ (full_data[<span class="st">'FirstPlayer_rank'</span>] <span class="op">&lt;</span> <span class="dv">20</span>) <span class="op">|</span> (full_data[<span class="st">'SecondPlayer__rank'</span>] <span class="op">&lt;</span> <span class="dv">20</span>) , :]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>fp_data <span class="op">=</span> full_data.copy()</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>sp_data <span class="op">=</span> full_data.copy()</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># fp_data = fp_data.loc[[fp_data['label'] == 1]]</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sp_data = sp_data.loc[[sp_data['label'] == 0]]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>sn <span class="op">=</span> <span class="bu">list</span>(fp_data[<span class="st">'SecondPlayer__name'</span>].unique())</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>fn <span class="op">=</span> <span class="bu">list</span>(fp_data[<span class="st">'FirstPlayer_name'</span>].unique())</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> fn <span class="cf">if</span> x <span class="kw">not</span> <span class="kw">in</span> sn]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="24">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>overview_cl1 <span class="op">=</span> pd.merge(overview_cl,</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                          full_data[[<span class="st">'match_id'</span>]] ,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                          on<span class="op">=</span>[<span class="st">'match_id'</span>] ,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                          how<span class="op">=</span><span class="st">"right"</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># overview_cl1.drop(overview_cl1.columns.to_list()[2:33], axis=1, inplace=True)</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>overview_cl1.info() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 1296 entries, 0 to 1295
Data columns (total 33 columns):
 #   Column          Non-Null Count  Dtype  
---  ------          --------------  -----  
 0   match_id        1296 non-null   object 
 1   player          1296 non-null   int64  
 2   set             1296 non-null   object 
 3   serve_pts       1296 non-null   float64
 4   aces            1296 non-null   float64
 5   dfs             1296 non-null   float64
 6   first_in        1296 non-null   float64
 7   first_won       1296 non-null   float64
 8   second_in       1296 non-null   float64
 9   second_won      1296 non-null   float64
 10  bk_pts          1296 non-null   float64
 11  bp_saved        1296 non-null   float64
 12  return_pts      1296 non-null   float64
 13  return_pts_won  1296 non-null   float64
 14  winners         1296 non-null   float64
 15  winners_fh      1296 non-null   float64
 16  winners_bh      1296 non-null   float64
 17  unforced        1296 non-null   float64
 18  unforced_fh     1296 non-null   float64
 19  unforced_bh     1296 non-null   float64
 20  returnable      1296 non-null   float64
 21  shallow         1296 non-null   float64
 22  deep            1296 non-null   float64
 23  very_deep       1296 non-null   float64
 24  err_net         1296 non-null   float64
 25  err_deep        1296 non-null   float64
 26  err_wide        1296 non-null   float64
 27  err_wide_deep   1296 non-null   float64
 28  crosscourt      1296 non-null   int64  
 29  down_middle     1296 non-null   int64  
 30  down_the_line   1296 non-null   int64  
 31  inside_out      1296 non-null   int64  
 32  inside_in       1296 non-null   int64  
dtypes: float64(25), int64(6), object(2)
memory usage: 344.2+ KB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="25">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>missing_val_count_by_column <span class="op">=</span> (overview_cl1.isnull().<span class="bu">sum</span>())</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(missing_val_count_by_column[missing_val_count_by_column <span class="op">&gt;</span> <span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series([], dtype: int64)</code></pre>
</div>
</div>
<p>For the player name</p>
<div class="cell" data-execution_count="26">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>overview_cl1[[<span class="st">'tourney_date'</span>, <span class="st">'sm'</span>, <span class="st">'tourney_name'</span>, <span class="st">'sm2'</span>, <span class="st">'player1'</span>,</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">'player2'</span>]] <span class="op">=</span> overview_cl1[<span class="st">'match_id'</span>].<span class="bu">str</span>.split(<span class="st">'-'</span>, <span class="dv">6</span>, expand<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>zeros <span class="op">=</span> np.zeros(overview_cl1.shape[<span class="dv">0</span>])</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'player_name'</span>] <span class="op">=</span> zeros</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(overview_cl1[<span class="st">'player'</span>]) ): </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> overview_cl1[<span class="st">'player'</span>][i] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(overview_cl1['player1'][i])</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>        overview_cl1[<span class="st">'player_name'</span>][i] <span class="op">=</span> overview_cl1[<span class="st">'player1'</span>][i]</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> : </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>        overview_cl1[<span class="st">'player_name'</span>][i] <span class="op">=</span> overview_cl1[<span class="st">'player2'</span>][i]</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>overview_cl1.drop([<span class="st">'tourney_date'</span>, <span class="st">'sm'</span>, <span class="st">'sm2'</span>,<span class="st">'player1'</span>,<span class="st">'player2'</span>,<span class="st">'tourney_name'</span>,<span class="st">'player'</span>,<span class="st">'match_id'</span>,<span class="st">'set'</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>first_column <span class="op">=</span> overview_cl1.pop(<span class="st">'player_name'</span>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co"># insert column using insert(position,column_name,</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co"># first_column) function</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>overview_cl1.insert(<span class="dv">0</span>, <span class="st">'player_name'</span>, first_column)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>overview_cl1.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_3863/2729871903.py:8: SettingWithCopyWarning:


A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy

/opt/conda/lib/python3.9/site-packages/pandas/core/indexing.py:1732: SettingWithCopyWarning:


A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="27">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>player_name</th>
      <th>serve_pts</th>
      <th>aces</th>
      <th>dfs</th>
      <th>first_in</th>
      <th>first_won</th>
      <th>second_in</th>
      <th>second_won</th>
      <th>bk_pts</th>
      <th>bp_saved</th>
      <th>...</th>
      <th>very_deep</th>
      <th>err_net</th>
      <th>err_deep</th>
      <th>err_wide</th>
      <th>err_wide_deep</th>
      <th>crosscourt</th>
      <th>down_middle</th>
      <th>down_the_line</th>
      <th>inside_out</th>
      <th>inside_in</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Rafael_Nadal</td>
      <td>47.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>31.0</td>
      <td>21.0</td>
      <td>16.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>65</td>
      <td>29</td>
      <td>22</td>
      <td>17</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>David_Nalbandian</td>
      <td>41.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>24.0</td>
      <td>21.0</td>
      <td>17.0</td>
      <td>13.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>14.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>79</td>
      <td>26</td>
      <td>19</td>
      <td>19</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Tomas_Berdych</td>
      <td>81.0</td>
      <td>13.0</td>
      <td>0.0</td>
      <td>48.0</td>
      <td>35.0</td>
      <td>33.0</td>
      <td>19.0</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>77</td>
      <td>45</td>
      <td>21</td>
      <td>34</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Rafael_Nadal</td>
      <td>90.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>62.0</td>
      <td>48.0</td>
      <td>28.0</td>
      <td>18.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>78</td>
      <td>49</td>
      <td>41</td>
      <td>28</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Roger_Federer</td>
      <td>58.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>35.0</td>
      <td>22.0</td>
      <td>23.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>55</td>
      <td>34</td>
      <td>15</td>
      <td>30</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 31 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="27">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>missing_val_count_by_column <span class="op">=</span> (overview_cl1.isnull().<span class="bu">sum</span>())</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(missing_val_count_by_column[missing_val_count_by_column <span class="op">&gt;</span> <span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series([], dtype: int64)</code></pre>
</div>
</div>
<p>To add the new features for clustering</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'first_serve_percen'</span>]<span class="op">=</span>overview_cl1[<span class="st">'first_in'</span>]<span class="op">/</span>overview_cl1[<span class="st">'serve_pts'</span>]</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'first_serve_pts_won_percen'</span>]<span class="op">=</span>overview_cl1[<span class="st">'first_won'</span>]<span class="op">/</span>overview_cl1[<span class="st">'first_in'</span>]</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'second_serve_pts_won_percen'</span>]<span class="op">=</span>overview_cl1[<span class="st">'second_won'</span>]<span class="op">/</span>overview_cl1[<span class="st">'second_in'</span>]</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'ace_percen'</span>]<span class="op">=</span>overview_cl1[<span class="st">'aces'</span>]<span class="op">/</span>overview_cl1[<span class="st">'serve_pts'</span>]</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'return_pts_won_percen'</span>]<span class="op">=</span>overview_cl1[<span class="st">'return_pts_won'</span>]<span class="op">/</span>overview_cl1[<span class="st">'return_pts'</span>]</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'percen_unsafe_shots_made'</span>]<span class="op">=</span>overview_cl1[[<span class="st">'down_the_line'</span>,<span class="st">'inside_out'</span>,<span class="st">'inside_in'</span>]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)<span class="op">/</span>overview_cl1[[<span class="st">'down_the_line'</span>,<span class="st">'inside_out'</span>,<span class="st">'inside_in'</span>,<span class="st">'crosscourt'</span>,<span class="st">'down_middle'</span>]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'percen_safe_shots_made'</span>]<span class="op">=</span>overview_cl1[[<span class="st">'crosscourt'</span>,<span class="st">'down_middle'</span>]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)<span class="op">/</span>overview_cl1[[<span class="st">'down_the_line'</span>,<span class="st">'inside_out'</span>,<span class="st">'inside_in'</span>,<span class="st">'crosscourt'</span>,<span class="st">'down_middle'</span>]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'break_pts_percen'</span>]<span class="op">=</span>overview_cl1[<span class="st">'bk_pts'</span>]<span class="op">/</span>overview_cl1[<span class="st">'serve_pts'</span>]</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'percen_err_returnable_made'</span>]<span class="op">=</span>overview_cl1[[<span class="st">'err_net'</span>,<span class="st">'err_deep'</span>,<span class="st">'err_wide'</span>,<span class="st">'err_wide_deep'</span>]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)<span class="op">/</span>overview_cl1[<span class="st">'returnable'</span>]</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'percen_returnable_made'</span>]<span class="op">=</span>overview_cl1[[<span class="st">'shallow'</span>,<span class="st">'deep'</span>,<span class="st">'very_deep'</span>]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)<span class="op">/</span>overview_cl1[<span class="st">'returnable'</span>]</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'bp_pts_saved_percen'</span>]<span class="op">=</span>overview_cl1[<span class="st">'bp_saved'</span>]<span class="op">/</span>overview_cl1[<span class="st">'bk_pts'</span>]</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'percen_winners_fh_made'</span>]<span class="op">=</span>overview_cl1[<span class="st">'winners_fh'</span>]<span class="op">/</span>overview_cl1[[<span class="st">'winners_fh'</span>,<span class="st">'winners_bh'</span>,<span class="st">'winners'</span>]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'percen_winners_bh_made'</span>]<span class="op">=</span>overview_cl1[<span class="st">'winners_bh'</span>]<span class="op">/</span>overview_cl1[[<span class="st">'winners_fh'</span>,<span class="st">'winners_bh'</span>,<span class="st">'winners'</span>]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'percen_unforced_fh_made'</span>]<span class="op">=</span>overview_cl1[<span class="st">'unforced_fh'</span>]<span class="op">/</span>overview_cl1[[<span class="st">'unforced'</span>,<span class="st">'unforced_bh'</span>,<span class="st">'unforced_fh'</span>]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'percen_unforced_bh_made'</span>]<span class="op">=</span>overview_cl1[<span class="st">'unforced_bh'</span>]<span class="op">/</span>overview_cl1[[<span class="st">'unforced'</span>,<span class="st">'unforced_bh'</span>,<span class="st">'unforced_fh'</span>]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'shallow_percen'</span>]<span class="op">=</span>overview_cl1[<span class="st">'shallow'</span>]<span class="op">/</span>overview_cl1[<span class="st">'returnable'</span>]</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'deep_percen'</span>]<span class="op">=</span>overview_cl1[<span class="st">'deep'</span>]<span class="op">/</span>overview_cl1[<span class="st">'returnable'</span>]</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'very_deep_percen'</span>]<span class="op">=</span>overview_cl1[<span class="st">'very_deep'</span>]<span class="op">/</span>overview_cl1[<span class="st">'returnable'</span>]</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'err_net_percen'</span>]<span class="op">=</span>overview_cl1[<span class="st">'err_net'</span>]<span class="op">/</span>overview_cl1[<span class="st">'returnable'</span>]</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'err_deep_percen'</span>]<span class="op">=</span>overview_cl1[<span class="st">'err_deep'</span>]<span class="op">/</span>overview_cl1[<span class="st">'returnable'</span>]</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'err_wide_percen'</span>]<span class="op">=</span>overview_cl1[<span class="st">'err_wide'</span>]<span class="op">/</span>overview_cl1[<span class="st">'returnable'</span>]</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>overview_cl1[<span class="st">'err_wide_deep_percen'</span>]<span class="op">=</span>overview_cl1[<span class="st">'err_wide_deep'</span>]<span class="op">/</span>overview_cl1[<span class="st">'returnable'</span>]</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="29">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>overview_cl1.drop(overview_cl1.columns.tolist()[<span class="dv">1</span>:<span class="dv">31</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>overview_cl1.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="30">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>player_name</th>
      <th>first_serve_percen</th>
      <th>first_serve_pts_won_percen</th>
      <th>second_serve_pts_won_percen</th>
      <th>ace_percen</th>
      <th>return_pts_won_percen</th>
      <th>percen_unsafe_shots_made</th>
      <th>percen_safe_shots_made</th>
      <th>break_pts_percen</th>
      <th>percen_err_returnable_made</th>
      <th>...</th>
      <th>percen_winners_bh_made</th>
      <th>percen_unforced_fh_made</th>
      <th>percen_unforced_bh_made</th>
      <th>shallow_percen</th>
      <th>deep_percen</th>
      <th>very_deep_percen</th>
      <th>err_net_percen</th>
      <th>err_deep_percen</th>
      <th>err_wide_percen</th>
      <th>err_wide_deep_percen</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Rafael_Nadal</td>
      <td>0.659574</td>
      <td>0.677419</td>
      <td>0.187500</td>
      <td>0.021277</td>
      <td>0.170732</td>
      <td>0.303704</td>
      <td>0.696296</td>
      <td>0.127660</td>
      <td>0.032258</td>
      <td>...</td>
      <td>0.111111</td>
      <td>0.173913</td>
      <td>0.304348</td>
      <td>0.419355</td>
      <td>0.548387</td>
      <td>0.225806</td>
      <td>0.000000</td>
      <td>0.032258</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>David_Nalbandian</td>
      <td>0.585366</td>
      <td>0.875000</td>
      <td>0.764706</td>
      <td>0.121951</td>
      <td>0.489362</td>
      <td>0.265734</td>
      <td>0.734266</td>
      <td>0.000000</td>
      <td>0.025000</td>
      <td>...</td>
      <td>0.093023</td>
      <td>0.107143</td>
      <td>0.392857</td>
      <td>0.300000</td>
      <td>0.675000</td>
      <td>0.350000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.025000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Tomas_Berdych</td>
      <td>0.592593</td>
      <td>0.729167</td>
      <td>0.575758</td>
      <td>0.160494</td>
      <td>0.266667</td>
      <td>0.325967</td>
      <td>0.674033</td>
      <td>0.074074</td>
      <td>0.017544</td>
      <td>...</td>
      <td>0.073171</td>
      <td>0.369565</td>
      <td>0.130435</td>
      <td>0.298246</td>
      <td>0.684211</td>
      <td>0.122807</td>
      <td>0.000000</td>
      <td>0.017544</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Rafael_Nadal</td>
      <td>0.688889</td>
      <td>0.774194</td>
      <td>0.642857</td>
      <td>0.055556</td>
      <td>0.333333</td>
      <td>0.377451</td>
      <td>0.622549</td>
      <td>0.044444</td>
      <td>0.083333</td>
      <td>...</td>
      <td>0.058824</td>
      <td>0.228070</td>
      <td>0.245614</td>
      <td>0.266667</td>
      <td>0.650000</td>
      <td>0.133333</td>
      <td>0.016667</td>
      <td>0.033333</td>
      <td>0.033333</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Roger_Federer</td>
      <td>0.603448</td>
      <td>0.628571</td>
      <td>0.391304</td>
      <td>0.086207</td>
      <td>0.265306</td>
      <td>0.350365</td>
      <td>0.649635</td>
      <td>0.172414</td>
      <td>0.033333</td>
      <td>...</td>
      <td>0.103448</td>
      <td>0.283019</td>
      <td>0.207547</td>
      <td>0.233333</td>
      <td>0.733333</td>
      <td>0.400000</td>
      <td>0.000000</td>
      <td>0.033333</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 23 columns</p>
</div>
</div>
</div>
<p>Create a new dataset grouped by the player and the other columns average so every player have one row</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>overview_for_c <span class="op">=</span> overview_cl1.groupby([<span class="st">'player_name'</span>])[overview_cl1.columns.tolist()[<span class="dv">1</span>:]].agg(<span class="st">'mean'</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>c_names <span class="op">=</span> overview_for_c.columns.tolist()</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>overview_for_c <span class="op">=</span> overview_for_c.rename_axis(c_names.insert(<span class="dv">0</span>, <span class="st">'player_name'</span>)).reset_index()</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>overview_for_c.rename(columns<span class="op">=</span>{<span class="st">'index'</span>: <span class="st">'player_name'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>names <span class="op">=</span> overview_for_c.iloc[:,<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_dataset(df):</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="bu">isinstance</span>(df, pd.DataFrame), <span class="st">"df needs to be a pd.DataFrame"</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    df.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    indices_to_keep <span class="op">=</span> <span class="op">~</span>df.isin([np.nan, np.inf, <span class="op">-</span>np.inf]).<span class="bu">any</span>(<span class="dv">1</span>)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df[indices_to_keep].astype(np.float64)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>overview_for_c <span class="op">=</span> clean_dataset(overview_for_c.iloc[:,<span class="dv">1</span>:])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="33">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>overview_for_c_names  <span class="op">=</span> pd.concat((names , overview_for_c.reset_index(drop <span class="op">=</span> <span class="va">True</span>)  ), join <span class="op">=</span> <span class="st">'inner'</span>,axis <span class="op">=</span> <span class="dv">1</span>) </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>overview_for_c_names.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="34">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>player_name</th>
      <th>first_serve_percen</th>
      <th>first_serve_pts_won_percen</th>
      <th>second_serve_pts_won_percen</th>
      <th>ace_percen</th>
      <th>return_pts_won_percen</th>
      <th>percen_unsafe_shots_made</th>
      <th>percen_safe_shots_made</th>
      <th>break_pts_percen</th>
      <th>percen_err_returnable_made</th>
      <th>...</th>
      <th>percen_winners_bh_made</th>
      <th>percen_unforced_fh_made</th>
      <th>percen_unforced_bh_made</th>
      <th>shallow_percen</th>
      <th>deep_percen</th>
      <th>very_deep_percen</th>
      <th>err_net_percen</th>
      <th>err_deep_percen</th>
      <th>err_wide_percen</th>
      <th>err_wide_deep_percen</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adrian_Mannarino</td>
      <td>0.709162</td>
      <td>0.681863</td>
      <td>0.534258</td>
      <td>0.104436</td>
      <td>0.338361</td>
      <td>0.194624</td>
      <td>0.805376</td>
      <td>0.105453</td>
      <td>0.035706</td>
      <td>...</td>
      <td>0.207112</td>
      <td>0.281518</td>
      <td>0.201881</td>
      <td>0.203574</td>
      <td>0.734269</td>
      <td>0.246669</td>
      <td>0.004762</td>
      <td>0.021927</td>
      <td>0.009017</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Albert_Montanes</td>
      <td>0.631579</td>
      <td>0.444444</td>
      <td>0.333333</td>
      <td>0.000000</td>
      <td>0.392157</td>
      <td>0.452830</td>
      <td>0.547170</td>
      <td>0.175439</td>
      <td>0.025000</td>
      <td>...</td>
      <td>0.038462</td>
      <td>0.277778</td>
      <td>0.166667</td>
      <td>0.275000</td>
      <td>0.850000</td>
      <td>0.500000</td>
      <td>0.025000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albert_Ramos</td>
      <td>0.625082</td>
      <td>0.667510</td>
      <td>0.586321</td>
      <td>0.012351</td>
      <td>0.410467</td>
      <td>0.241096</td>
      <td>0.758904</td>
      <td>0.085731</td>
      <td>0.024752</td>
      <td>...</td>
      <td>0.113287</td>
      <td>0.326720</td>
      <td>0.122134</td>
      <td>0.269205</td>
      <td>0.696142</td>
      <td>0.249403</td>
      <td>0.009901</td>
      <td>0.009901</td>
      <td>0.004950</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Alejandro_Davidovich_Fokina</td>
      <td>0.683261</td>
      <td>0.628955</td>
      <td>0.365751</td>
      <td>0.019703</td>
      <td>0.375307</td>
      <td>0.278689</td>
      <td>0.721311</td>
      <td>0.138341</td>
      <td>0.044444</td>
      <td>...</td>
      <td>0.180725</td>
      <td>0.219221</td>
      <td>0.242762</td>
      <td>0.204392</td>
      <td>0.624346</td>
      <td>0.262462</td>
      <td>0.018687</td>
      <td>0.017256</td>
      <td>0.005461</td>
      <td>0.00304</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Aleksandar_Vukic</td>
      <td>0.604208</td>
      <td>0.698708</td>
      <td>0.443229</td>
      <td>0.031726</td>
      <td>0.371921</td>
      <td>0.268400</td>
      <td>0.731600</td>
      <td>0.105930</td>
      <td>0.030299</td>
      <td>...</td>
      <td>0.181953</td>
      <td>0.278116</td>
      <td>0.201546</td>
      <td>0.138186</td>
      <td>0.691085</td>
      <td>0.303736</td>
      <td>0.008076</td>
      <td>0.011822</td>
      <td>0.010402</td>
      <td>0.00000</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 23 columns</p>
</div>
</div>
</div>
</section>
<section id="pca" class="level2">
<h2 class="anchored" data-anchor-id="pca">PCA</h2>
<div class="cell" data-execution_count="34">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">3</span>) </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>scores_pca <span class="op">=</span> pca.fit_transform(overview_for_c)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pca.explained_variance_ratio_)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ind,var <span class="kw">in</span> <span class="bu">enumerate</span>(pca.explained_variance_ratio_):</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'The variance captured by pca </span><span class="sc">{</span>ind<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss"> is: </span><span class="sc">{</span>var<span class="op">*</span><span class="dv">100</span><span class="sc">: 0.2f}</span><span class="ss">%'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[0.52156339 0.17204597 0.05929471]
The variance captured by pca 1 is:  52.16%
The variance captured by pca 2 is:  17.20%
The variance captured by pca 3 is:  5.93%</code></pre>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>WCSS <span class="op">=</span> []</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">10</span>) : </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    kmeans_pca <span class="op">=</span> KMeans(n_clusters<span class="op">=</span> i , init <span class="op">=</span> <span class="st">'k-means++'</span>,random_state<span class="op">=</span><span class="dv">42</span> )</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    kmeans_pca.fit(scores_pca)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    WCSS.append(kmeans_pca.inertia_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>Choose the number of k</p>
<div class="cell" data-execution_count="36">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">8</span>))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">10</span>), WCSS,marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'K-Means with PCA Clustering'</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="pre_files/figure-html/cell-37-output-1.png" width="790" height="641"></p>
</div>
</div>
<div class="cell" data-execution_count="37">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>kmeans_pca <span class="op">=</span> KMeans(n_clusters<span class="op">=</span> <span class="dv">3</span> , init <span class="op">=</span> <span class="st">'k-means++'</span>,random_state<span class="op">=</span><span class="dv">42</span> )</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>kmeans_pca.fit(scores_pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>KMeans(n_clusters=3, random_state=42)</code></pre>
</div>
</div>
<p>adding the pca1,2,3 and clusters</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>scores_pca <span class="op">=</span> pd.DataFrame(scores_pca) </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>overview_KMeans <span class="op">=</span> pd.concat((overview_for_c.reset_index(drop <span class="op">=</span> <span class="va">True</span>) , scores_pca ), axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>overview_KMeans.columns.values[<span class="op">-</span><span class="dv">3</span>:] <span class="op">=</span> [<span class="st">'pca1'</span>, <span class="st">'pca2'</span>,<span class="st">'pca3'</span>]</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>overview_KMeans[<span class="st">'Group KMeans PCA'</span>] <span class="op">=</span> kmeans_pca.labels_</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>overview_KMeans  <span class="op">=</span> pd.concat((names , overview_KMeans.reset_index(drop <span class="op">=</span> <span class="va">True</span>)  ), join <span class="op">=</span> <span class="st">'inner'</span>,axis <span class="op">=</span> <span class="dv">1</span>) </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>overview_KMeans[<span class="st">'player_name'</span>] <span class="op">=</span> overview_KMeans[<span class="st">'player_name'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x : x.replace(<span class="st">'_'</span>, <span class="st">" "</span>))</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="39">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>overview_KMeans.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="40">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>player_name</th>
      <th>first_serve_percen</th>
      <th>first_serve_pts_won_percen</th>
      <th>second_serve_pts_won_percen</th>
      <th>ace_percen</th>
      <th>return_pts_won_percen</th>
      <th>percen_unsafe_shots_made</th>
      <th>percen_safe_shots_made</th>
      <th>break_pts_percen</th>
      <th>percen_err_returnable_made</th>
      <th>...</th>
      <th>deep_percen</th>
      <th>very_deep_percen</th>
      <th>err_net_percen</th>
      <th>err_deep_percen</th>
      <th>err_wide_percen</th>
      <th>err_wide_deep_percen</th>
      <th>pca1</th>
      <th>pca2</th>
      <th>pca3</th>
      <th>Group KMeans PCA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adrian Mannarino</td>
      <td>0.709162</td>
      <td>0.681863</td>
      <td>0.534258</td>
      <td>0.104436</td>
      <td>0.338361</td>
      <td>0.194624</td>
      <td>0.805376</td>
      <td>0.105453</td>
      <td>0.035706</td>
      <td>...</td>
      <td>0.734269</td>
      <td>0.246669</td>
      <td>0.004762</td>
      <td>0.021927</td>
      <td>0.009017</td>
      <td>0.00000</td>
      <td>-0.103691</td>
      <td>-0.026227</td>
      <td>0.110787</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Albert Montanes</td>
      <td>0.631579</td>
      <td>0.444444</td>
      <td>0.333333</td>
      <td>0.000000</td>
      <td>0.392157</td>
      <td>0.452830</td>
      <td>0.547170</td>
      <td>0.175439</td>
      <td>0.025000</td>
      <td>...</td>
      <td>0.850000</td>
      <td>0.500000</td>
      <td>0.025000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>-0.636546</td>
      <td>0.254509</td>
      <td>-0.248483</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albert Ramos</td>
      <td>0.625082</td>
      <td>0.667510</td>
      <td>0.586321</td>
      <td>0.012351</td>
      <td>0.410467</td>
      <td>0.241096</td>
      <td>0.758904</td>
      <td>0.085731</td>
      <td>0.024752</td>
      <td>...</td>
      <td>0.696142</td>
      <td>0.249403</td>
      <td>0.009901</td>
      <td>0.009901</td>
      <td>0.004950</td>
      <td>0.00000</td>
      <td>-0.138618</td>
      <td>-0.149597</td>
      <td>0.073711</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Alejandro Davidovich Fokina</td>
      <td>0.683261</td>
      <td>0.628955</td>
      <td>0.365751</td>
      <td>0.019703</td>
      <td>0.375307</td>
      <td>0.278689</td>
      <td>0.721311</td>
      <td>0.138341</td>
      <td>0.044444</td>
      <td>...</td>
      <td>0.624346</td>
      <td>0.262462</td>
      <td>0.018687</td>
      <td>0.017256</td>
      <td>0.005461</td>
      <td>0.00304</td>
      <td>0.005312</td>
      <td>0.020685</td>
      <td>-0.083321</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Aleksandar Vukic</td>
      <td>0.604208</td>
      <td>0.698708</td>
      <td>0.443229</td>
      <td>0.031726</td>
      <td>0.371921</td>
      <td>0.268400</td>
      <td>0.731600</td>
      <td>0.105930</td>
      <td>0.030299</td>
      <td>...</td>
      <td>0.691085</td>
      <td>0.303736</td>
      <td>0.008076</td>
      <td>0.011822</td>
      <td>0.010402</td>
      <td>0.00000</td>
      <td>-0.057365</td>
      <td>0.103668</td>
      <td>0.018225</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 27 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="40">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>x_axis <span class="op">=</span> overview_KMeans[<span class="st">'pca1'</span>]</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>y_axis <span class="op">=</span> overview_KMeans[<span class="st">'pca2'</span>] </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">8</span>))</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x <span class="op">=</span> x_axis , y <span class="op">=</span> y_axis , hue <span class="op">=</span> <span class="st">'Group KMeans PCA'</span> , data <span class="op">=</span> overview_KMeans )</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'K-Means with PCA Clustering'</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="pre_files/figure-html/cell-41-output-1.png" width="823" height="660"></p>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#overview_KMeans_vis.drop(columns=['Group KMeans PCA']).columns.tolist()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="43">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">7</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span>))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>selected_r <span class="op">=</span> overview_KMeans_vis.drop(columns<span class="op">=</span>[<span class="st">'Group KMeans PCA'</span>]).columns.tolist()</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> variable, subplot <span class="kw">in</span> <span class="bu">zip</span>(selected_r, ax.flatten()):</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    sns.scatterplot( x<span class="op">=</span> <span class="st">'deep_percen'</span> , y <span class="op">=</span> variable, hue <span class="op">=</span> <span class="st">'Group KMeans PCA'</span> ,  data <span class="op">=</span> overview_KMeans_vis,  ax<span class="op">=</span>subplot)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> label <span class="kw">in</span> subplot.get_xticklabels():</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>        label.set_rotation(<span class="dv">90</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="pre_files/figure-html/cell-44-output-1.png" width="1573" height="1532"></p>
</div>
</div>
<div class="cell" data-execution_count="44">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">7</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span>))</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>selected_r <span class="op">=</span> overview_KMeans_vis.drop(columns<span class="op">=</span>[<span class="st">'Group KMeans PCA'</span>]).columns.tolist()</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> variable, subplot <span class="kw">in</span> <span class="bu">zip</span>(selected_r, ax.flatten()):</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    sns.scatterplot( x<span class="op">=</span> <span class="st">'very_deep_percen'</span> , y <span class="op">=</span> variable, hue <span class="op">=</span> <span class="st">'Group KMeans PCA'</span> ,  data <span class="op">=</span> overview_KMeans_vis,  ax<span class="op">=</span>subplot)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> label <span class="kw">in</span> subplot.get_xticklabels():</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>        label.set_rotation(<span class="dv">90</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="pre_files/figure-html/cell-45-output-1.png" width="1573" height="1532"></p>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print(list(overview_KMeans['player_name']))</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># print(list(full_data['FirstPlayer_name'].unique() )) </span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>l1 <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(<span class="bu">list</span>(overview_KMeans[<span class="st">'player_name'</span>]),<span class="bu">list</span>(overview_KMeans[<span class="st">'Group KMeans PCA'</span>])))</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>l2 <span class="op">=</span> <span class="bu">list</span>(full_data[<span class="st">'SecondPlayer__name'</span>].unique() ) <span class="op">+</span>  <span class="bu">list</span>(full_data[<span class="st">'FirstPlayer_name'</span>].unique() )</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>main_list <span class="op">=</span> np.setdiff1d(l1,l2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>add the cluster to the full data</p>
<div class="cell" data-execution_count="46">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>label_data  <span class="op">=</span> pd.DataFrame(<span class="bu">list</span>(l1.items()), columns <span class="op">=</span> [<span class="st">'FirstPlayer_name'</span>,<span class="st">'cluster'</span>])</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>label_data</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>cluster_data  <span class="op">=</span> pd.merge(full_data,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>                       label_data,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>                       on<span class="op">=</span>[<span class="st">'FirstPlayer_name'</span>],</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>                       how<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>cluster_data.info()</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 648 entries, 0 to 647
Data columns (total 88 columns):
 #   Column                           Non-Null Count  Dtype  
---  ------                           --------------  -----  
 0   tourney_id                       648 non-null    object 
 1   tourney_name                     648 non-null    object 
 2   surface                          648 non-null    object 
 3   draw_size                        648 non-null    float64
 4   tourney_level                    648 non-null    object 
 5   tourney_date                     648 non-null    float64
 6   match_num                        648 non-null    float64
 7   FirstPlayer_id                   648 non-null    float64
 8   FirstPlayer_seed                 436 non-null    object 
 9   FirstPlayer_entry                66 non-null     object 
 10  FirstPlayer_name                 648 non-null    object 
 11  FirstPlayer_hand                 648 non-null    object 
 12  FirstPlayer_ht                   648 non-null    float64
 13  FirstPlayer_ioc                  648 non-null    object 
 14  FirstPlayer_age                  648 non-null    float64
 15  SecondPlayer__id                 648 non-null    float64
 16  SecondPlayer__seed               340 non-null    object 
 17  SecondPlayer__entry              84 non-null     object 
 18  SecondPlayer__name               648 non-null    object 
 19  SecondPlayer__hand               648 non-null    object 
 20  SecondPlayer__ht                 648 non-null    float64
 21  SecondPlayer__ioc                648 non-null    object 
 22  SecondPlayer__age                648 non-null    float64
 23  score                            648 non-null    object 
 24  best_of                          648 non-null    float64
 25  round                            648 non-null    object 
 26  minutes                          648 non-null    float64
 27  fp_ace                           648 non-null    float64
 28  fp_df                            648 non-null    float64
 29  fp_svpt                          648 non-null    float64
 30  fp_1stIn                         648 non-null    float64
 31  fp_1stWon                        648 non-null    float64
 32  fp_2ndWon                        648 non-null    float64
 33  fp_SvGms                         648 non-null    float64
 34  fp_bpSaved                       648 non-null    float64
 35  fp_bpFaced                       648 non-null    float64
 36  sp_ace                           648 non-null    float64
 37  sp_df                            648 non-null    float64
 38  sp_svpt                          648 non-null    float64
 39  sp_1stIn                         648 non-null    float64
 40  sp_1stWon                        648 non-null    float64
 41  sp_2ndWon                        648 non-null    float64
 42  sp_SvGms                         648 non-null    float64
 43  sp_bpSaved                       648 non-null    float64
 44  sp_bpFaced                       648 non-null    float64
 45  FirstPlayer_rank                 648 non-null    float64
 46  FirstPlayer_rank_points          648 non-null    float64
 47  SecondPlayer__rank               648 non-null    float64
 48  SecondPlayer__rank_points        648 non-null    float64
 49  match_id                         648 non-null    object 
 50  fp_winners_fh                    648 non-null    float64
 51  fp_winners_bh                    648 non-null    float64
 52  fp_unforced_fh                   648 non-null    float64
 53  fp_unforced_bh                   648 non-null    float64
 54  fp_return_pts_faced              648 non-null    float64
 55  fp_return_pts_won                648 non-null    float64
 56  fp_return_depth_very_deep        648 non-null    float64
 57  fp_return_depth_shallow          648 non-null    float64
 58  fp_return_depth_deep             648 non-null    float64
 59  fp_return_depth_err_net          648 non-null    float64
 60  fp_return_depth_err_deep         648 non-null    float64
 61  fp_return_depth_err_wide         648 non-null    float64
 62  fp_return_depth_wide_deep        648 non-null    float64
 63  fp_shot_Direction_crosscourt     648 non-null    float64
 64  fp_shot_Direction_down_middle    648 non-null    float64
 65  fp_shot_Direction_down_the_line  648 non-null    float64
 66  fp_shot_Direction_inside_out     648 non-null    float64
 67  fp_shot_Direction_inside_in      648 non-null    float64
 68  sp_winners_fh                    648 non-null    float64
 69  sp_winners_bh                    648 non-null    float64
 70  sp_unforced_fh                   648 non-null    float64
 71  sp_unforced_bh                   648 non-null    float64
 72  sp_return_pts_faced              648 non-null    float64
 73  sp_return_pts_won                648 non-null    float64
 74  sp_return_depth_very_deep        648 non-null    float64
 75  sp_return_depth_shallow          648 non-null    float64
 76  sp_return_depth_deep             648 non-null    float64
 77  sp_return_depth_err_net          648 non-null    float64
 78  sp_return_depth_err_deep         648 non-null    float64
 79  sp_return_depth_err_wide         648 non-null    float64
 80  sp_return_depth_wide_deep        648 non-null    float64
 81  sp_shot_Direction_crosscourt     648 non-null    float64
 82  sp_shot_Direction_down_middle    648 non-null    float64
 83  sp_shot_Direction_down_the_line  648 non-null    float64
 84  sp_shot_Direction_inside_out     648 non-null    float64
 85  sp_shot_Direction_inside_in      648 non-null    float64
 86  label                            648 non-null    float64
 87  cluster                          645 non-null    float64
dtypes: float64(71), object(17)
memory usage: 450.6+ KB</code></pre>
</div>
</div>
<p>null_rows because I joind the datasets by first player name as it has the most number of values from the cluster dataset</p>
<div class="cell" data-execution_count="47">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>l3 <span class="op">=</span> <span class="bu">list</span>(overview_KMeans[<span class="st">'player_name'</span>])</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>null_rows <span class="op">=</span> cluster_data.loc[<span class="op">~</span>cluster_data[<span class="st">'cluster'</span>].notnull()]</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>l4 <span class="op">=</span> <span class="bu">list</span>(null_rows[<span class="st">'SecondPlayer__name'</span>]) </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>display(null_rows[<span class="st">'SecondPlayer__name'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>215      Jordan Thompson
216       Alex De Minaur
217    Fernando Verdasco
Name: SecondPlayer__name, dtype: object</code></pre>
</div>
</div>
<p>manually filling the null values</p>
<div class="cell" data-execution_count="48">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>overview_KMeans.loc[overview_KMeans[<span class="st">'player_name'</span>].isin(l4)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="49">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>player_name</th>
      <th>first_serve_percen</th>
      <th>first_serve_pts_won_percen</th>
      <th>second_serve_pts_won_percen</th>
      <th>ace_percen</th>
      <th>return_pts_won_percen</th>
      <th>percen_unsafe_shots_made</th>
      <th>percen_safe_shots_made</th>
      <th>break_pts_percen</th>
      <th>percen_err_returnable_made</th>
      <th>...</th>
      <th>deep_percen</th>
      <th>very_deep_percen</th>
      <th>err_net_percen</th>
      <th>err_deep_percen</th>
      <th>err_wide_percen</th>
      <th>err_wide_deep_percen</th>
      <th>pca1</th>
      <th>pca2</th>
      <th>pca3</th>
      <th>Group KMeans PCA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>Alex De Minaur</td>
      <td>0.744966</td>
      <td>0.729730</td>
      <td>0.578947</td>
      <td>0.026846</td>
      <td>0.341935</td>
      <td>0.286201</td>
      <td>0.713799</td>
      <td>0.040268</td>
      <td>0.008000</td>
      <td>...</td>
      <td>0.712000</td>
      <td>0.312000</td>
      <td>0.008000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.220483</td>
      <td>0.027824</td>
      <td>0.123102</td>
      <td>1</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Fernando Verdasco</td>
      <td>0.631944</td>
      <td>0.833215</td>
      <td>0.496316</td>
      <td>0.094246</td>
      <td>0.261478</td>
      <td>0.271636</td>
      <td>0.728364</td>
      <td>0.024802</td>
      <td>0.040541</td>
      <td>...</td>
      <td>0.385135</td>
      <td>0.209459</td>
      <td>0.027027</td>
      <td>0.013514</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.541649</td>
      <td>0.263833</td>
      <td>0.132537</td>
      <td>2</td>
    </tr>
    <tr>
      <th>105</th>
      <td>Jordan Thompson</td>
      <td>0.658228</td>
      <td>0.673077</td>
      <td>0.555556</td>
      <td>0.088608</td>
      <td>0.304348</td>
      <td>0.342975</td>
      <td>0.657025</td>
      <td>0.088608</td>
      <td>0.113636</td>
      <td>...</td>
      <td>0.659091</td>
      <td>0.181818</td>
      <td>0.090909</td>
      <td>0.022727</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.031416</td>
      <td>-0.147009</td>
      <td>-0.028894</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 27 columns</p>
</div>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>cluster_data.iloc[<span class="dv">215</span>,<span class="dv">87</span>] <span class="op">=</span> <span class="dv">0</span>   </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>cluster_data.iloc[<span class="dv">216</span>,<span class="dv">87</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>cluster_data.iloc[<span class="dv">217</span>,<span class="dv">87</span>] <span class="op">=</span> <span class="dv">2</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>top_cluster_data <span class="op">=</span> cluster_data.loc[ (cluster_data[<span class="st">'FirstPlayer_rank'</span>] <span class="op">&lt;</span> <span class="dv">20</span>) <span class="op">|</span> (cluster_data[<span class="st">'SecondPlayer__rank'</span>] <span class="op">&lt;</span> <span class="dv">20</span>) , :]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>cluster data grouped by the names and the agg is max to get the highest rank for each player</p>
<div class="cell" data-execution_count="51">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>cluster_data_temp <span class="op">=</span> cluster_data.groupby([<span class="st">'FirstPlayer_name'</span>])[cluster_data.columns.tolist()[<span class="dv">1</span>:]].agg(<span class="st">'max'</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>c_names <span class="op">=</span> cluster_data_temp.columns.tolist()</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>cluster_data_temp <span class="op">=</span> cluster_data_temp.rename_axis(c_names.insert(<span class="dv">0</span>, <span class="st">'player_name'</span>)).reset_index()</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>cluster_data_temp.rename(columns<span class="op">=</span>{<span class="st">'index'</span>: <span class="st">'player_name'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>display(cluster_data_temp.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/conda/lib/python3.9/site-packages/pandas/core/apply.py:577: FutureWarning:

Dropping invalid columns in DataFrameGroupBy.max is deprecated. In a future version, a TypeError will be raised. Before calling .max, select only columns which should be valid for the function.
</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>player_name</th>
      <th>tourney_name</th>
      <th>surface</th>
      <th>draw_size</th>
      <th>tourney_level</th>
      <th>tourney_date</th>
      <th>match_num</th>
      <th>FirstPlayer_id</th>
      <th>FirstPlayer_name</th>
      <th>FirstPlayer_hand</th>
      <th>...</th>
      <th>sp_return_depth_err_deep</th>
      <th>sp_return_depth_err_wide</th>
      <th>sp_return_depth_wide_deep</th>
      <th>sp_shot_Direction_crosscourt</th>
      <th>sp_shot_Direction_down_middle</th>
      <th>sp_shot_Direction_down_the_line</th>
      <th>sp_shot_Direction_inside_out</th>
      <th>sp_shot_Direction_inside_in</th>
      <th>label</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adrian Mannarino</td>
      <td>Moscow</td>
      <td>Hard</td>
      <td>32.0</td>
      <td>A</td>
      <td>20181015.0</td>
      <td>293.0</td>
      <td>105173.0</td>
      <td>Adrian Mannarino</td>
      <td>L</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>21.0</td>
      <td>23.0</td>
      <td>5.0</td>
      <td>15.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Albert Ramos</td>
      <td>Indian Wells Masters</td>
      <td>Hard</td>
      <td>128.0</td>
      <td>M</td>
      <td>20190304.0</td>
      <td>266.0</td>
      <td>105077.0</td>
      <td>Albert Ramos</td>
      <td>L</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>54.0</td>
      <td>31.0</td>
      <td>23.0</td>
      <td>14.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Alejandro Davidovich Fokina</td>
      <td>Rome Masters</td>
      <td>Clay</td>
      <td>128.0</td>
      <td>M</td>
      <td>20220411.0</td>
      <td>299.0</td>
      <td>200221.0</td>
      <td>Alejandro Davidovich Fokina</td>
      <td>R</td>
      <td>...</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>214.0</td>
      <td>109.0</td>
      <td>71.0</td>
      <td>84.0</td>
      <td>21.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Alex De Minaur</td>
      <td>Tokyo</td>
      <td>Hard</td>
      <td>128.0</td>
      <td>G</td>
      <td>20220117.0</td>
      <td>300.0</td>
      <td>200282.0</td>
      <td>Alex De Minaur</td>
      <td>R</td>
      <td>...</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>292.0</td>
      <td>210.0</td>
      <td>59.0</td>
      <td>70.0</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Alex Molcan</td>
      <td>Australian Open</td>
      <td>Hard</td>
      <td>128.0</td>
      <td>G</td>
      <td>20220117.0</td>
      <td>132.0</td>
      <td>144684.0</td>
      <td>Alex Molcan</td>
      <td>L</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>287.0</td>
      <td>134.0</td>
      <td>83.0</td>
      <td>94.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 84 columns</p>
</div>
</div>
</div>
<p>does the top players grouped on one cluster ?</p>
<div class="cell" data-execution_count="52">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">8</span>))</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>sns.scatterplot( x <span class="op">=</span> <span class="st">'cluster'</span> , y <span class="op">=</span> <span class="st">'FirstPlayer_rank'</span> , data <span class="op">=</span> cluster_data_temp )</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="pre_files/figure-html/cell-53-output-1.png" width="816" height="640"></p>
</div>
</div>
<div class="cell" data-execution_count="53">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">8</span>))</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x <span class="op">=</span> <span class="st">'cluster'</span> , y <span class="op">=</span> <span class="st">'FirstPlayer_ht'</span> , data <span class="op">=</span> cluster_data )</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="pre_files/figure-html/cell-54-output-1.png" width="816" height="640"></p>
</div>
</div>
<div class="cell" data-execution_count="54">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">8</span>))</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(x <span class="op">=</span> <span class="st">'FirstPlayer_hand'</span> , hue <span class="op">=</span> <span class="st">'cluster'</span> , data <span class="op">=</span> cluster_data )</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="pre_files/figure-html/cell-55-output-1.png" width="816" height="640"></p>
</div>
</div>
</section>
<section id="ml" class="level2">
<h2 class="anchored" data-anchor-id="ml">ML</h2>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>class_data <span class="op">=</span> full_data.drop([<span class="st">'tourney_id'</span>,<span class="st">'tourney_name'</span>,<span class="st">'tourney_date'</span>,<span class="st">'match_num'</span>,<span class="st">'FirstPlayer_id'</span>,<span class="st">'FirstPlayer_seed'</span>,</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="st">'FirstPlayer_entry'</span>,<span class="st">'FirstPlayer_name'</span>,<span class="st">'SecondPlayer__id'</span>,<span class="st">'SecondPlayer__seed'</span>,<span class="st">'SecondPlayer__entry'</span>,<span class="st">'SecondPlayer__name'</span>,</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="st">'match_id'</span>,<span class="st">'FirstPlayer_ioc'</span>,<span class="st">'SecondPlayer__ioc'</span>,<span class="st">'score'</span>,<span class="st">'round'</span>,<span class="st">'FirstPlayer_rank_points'</span>,<span class="st">'SecondPlayer__rank_points'</span>] , axis <span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>cluster_class_data <span class="op">=</span> cluster_data.drop([<span class="st">'tourney_id'</span>,<span class="st">'tourney_name'</span>,<span class="st">'tourney_date'</span>,<span class="st">'match_num'</span>,<span class="st">'FirstPlayer_id'</span>,<span class="st">'FirstPlayer_seed'</span>,</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="st">'FirstPlayer_entry'</span>,<span class="st">'FirstPlayer_name'</span>,<span class="st">'SecondPlayer__id'</span>,<span class="st">'SecondPlayer__seed'</span>,<span class="st">'SecondPlayer__entry'</span>,<span class="st">'SecondPlayer__name'</span>,</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="st">'match_id'</span>,<span class="st">'FirstPlayer_ioc'</span>,<span class="st">'SecondPlayer__ioc'</span>,<span class="st">'score'</span>,<span class="st">'round'</span>,<span class="st">'FirstPlayer_rank_points'</span>,<span class="st">'SecondPlayer__rank_points'</span>] , axis <span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="56">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>class_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="57">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>surface</th>
      <th>draw_size</th>
      <th>tourney_level</th>
      <th>FirstPlayer_hand</th>
      <th>FirstPlayer_ht</th>
      <th>FirstPlayer_age</th>
      <th>SecondPlayer__hand</th>
      <th>SecondPlayer__ht</th>
      <th>SecondPlayer__age</th>
      <th>best_of</th>
      <th>...</th>
      <th>sp_return_depth_err_net</th>
      <th>sp_return_depth_err_deep</th>
      <th>sp_return_depth_err_wide</th>
      <th>sp_return_depth_wide_deep</th>
      <th>sp_shot_Direction_crosscourt</th>
      <th>sp_shot_Direction_down_middle</th>
      <th>sp_shot_Direction_down_the_line</th>
      <th>sp_shot_Direction_inside_out</th>
      <th>sp_shot_Direction_inside_in</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Hard</td>
      <td>48.0</td>
      <td>M</td>
      <td>R</td>
      <td>180.0</td>
      <td>25.8</td>
      <td>L</td>
      <td>185.0</td>
      <td>21.4</td>
      <td>3.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>65.0</td>
      <td>29.0</td>
      <td>22.0</td>
      <td>17.0</td>
      <td>2.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Grass</td>
      <td>128.0</td>
      <td>G</td>
      <td>L</td>
      <td>185.0</td>
      <td>24.0</td>
      <td>R</td>
      <td>196.0</td>
      <td>24.7</td>
      <td>5.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>77.0</td>
      <td>45.0</td>
      <td>21.0</td>
      <td>34.0</td>
      <td>4.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Hard</td>
      <td>32.0</td>
      <td>A</td>
      <td>R</td>
      <td>188.0</td>
      <td>23.7</td>
      <td>R</td>
      <td>185.0</td>
      <td>29.5</td>
      <td>3.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>55.0</td>
      <td>34.0</td>
      <td>15.0</td>
      <td>30.0</td>
      <td>3.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Clay</td>
      <td>128.0</td>
      <td>G</td>
      <td>L</td>
      <td>185.0</td>
      <td>24.9</td>
      <td>R</td>
      <td>185.0</td>
      <td>29.7</td>
      <td>5.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>163.0</td>
      <td>104.0</td>
      <td>56.0</td>
      <td>63.0</td>
      <td>8.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Clay</td>
      <td>56.0</td>
      <td>M</td>
      <td>L</td>
      <td>185.0</td>
      <td>25.8</td>
      <td>R</td>
      <td>188.0</td>
      <td>24.9</td>
      <td>3.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>63.0</td>
      <td>66.0</td>
      <td>20.0</td>
      <td>46.0</td>
      <td>4.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 68 columns</p>
</div>
</div>
</div>
<p>data after Label Encoder</p>
<div class="cell" data-execution_count="57">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>le <span class="op">=</span> preprocessing.LabelEncoder()</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> [<span class="st">'surface'</span>,<span class="st">'tourney_level'</span>,<span class="st">'FirstPlayer_hand'</span>,<span class="st">'SecondPlayer__hand'</span>]:</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>    class_data[i]<span class="op">=</span> le.fit_transform(class_data[i])</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>class_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="58">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>surface</th>
      <th>draw_size</th>
      <th>tourney_level</th>
      <th>FirstPlayer_hand</th>
      <th>FirstPlayer_ht</th>
      <th>FirstPlayer_age</th>
      <th>SecondPlayer__hand</th>
      <th>SecondPlayer__ht</th>
      <th>SecondPlayer__age</th>
      <th>best_of</th>
      <th>...</th>
      <th>sp_return_depth_err_net</th>
      <th>sp_return_depth_err_deep</th>
      <th>sp_return_depth_err_wide</th>
      <th>sp_return_depth_wide_deep</th>
      <th>sp_shot_Direction_crosscourt</th>
      <th>sp_shot_Direction_down_middle</th>
      <th>sp_shot_Direction_down_the_line</th>
      <th>sp_shot_Direction_inside_out</th>
      <th>sp_shot_Direction_inside_in</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>48.0</td>
      <td>4</td>
      <td>1</td>
      <td>180.0</td>
      <td>25.8</td>
      <td>0</td>
      <td>185.0</td>
      <td>21.4</td>
      <td>3.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>65.0</td>
      <td>29.0</td>
      <td>22.0</td>
      <td>17.0</td>
      <td>2.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>128.0</td>
      <td>3</td>
      <td>0</td>
      <td>185.0</td>
      <td>24.0</td>
      <td>1</td>
      <td>196.0</td>
      <td>24.7</td>
      <td>5.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>77.0</td>
      <td>45.0</td>
      <td>21.0</td>
      <td>34.0</td>
      <td>4.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>32.0</td>
      <td>0</td>
      <td>1</td>
      <td>188.0</td>
      <td>23.7</td>
      <td>1</td>
      <td>185.0</td>
      <td>29.5</td>
      <td>3.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>55.0</td>
      <td>34.0</td>
      <td>15.0</td>
      <td>30.0</td>
      <td>3.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>128.0</td>
      <td>3</td>
      <td>0</td>
      <td>185.0</td>
      <td>24.9</td>
      <td>1</td>
      <td>185.0</td>
      <td>29.7</td>
      <td>5.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>163.0</td>
      <td>104.0</td>
      <td>56.0</td>
      <td>63.0</td>
      <td>8.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>56.0</td>
      <td>4</td>
      <td>0</td>
      <td>185.0</td>
      <td>25.8</td>
      <td>1</td>
      <td>188.0</td>
      <td>24.9</td>
      <td>3.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>63.0</td>
      <td>66.0</td>
      <td>20.0</td>
      <td>46.0</td>
      <td>4.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 68 columns</p>
</div>
</div>
</div>
<p>cluster after Label Encoder. This dataset for using the cluster in the models</p>
<div class="cell" data-execution_count="58">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>le <span class="op">=</span> preprocessing.LabelEncoder()</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> [<span class="st">'surface'</span>,<span class="st">'tourney_level'</span>,<span class="st">'FirstPlayer_hand'</span>,<span class="st">'SecondPlayer__hand'</span>]:</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    cluster_class_data[i]<span class="op">=</span> le.fit_transform(cluster_class_data[i])</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>cluster_class_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="59">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>surface</th>
      <th>draw_size</th>
      <th>tourney_level</th>
      <th>FirstPlayer_hand</th>
      <th>FirstPlayer_ht</th>
      <th>FirstPlayer_age</th>
      <th>SecondPlayer__hand</th>
      <th>SecondPlayer__ht</th>
      <th>SecondPlayer__age</th>
      <th>best_of</th>
      <th>...</th>
      <th>sp_return_depth_err_deep</th>
      <th>sp_return_depth_err_wide</th>
      <th>sp_return_depth_wide_deep</th>
      <th>sp_shot_Direction_crosscourt</th>
      <th>sp_shot_Direction_down_middle</th>
      <th>sp_shot_Direction_down_the_line</th>
      <th>sp_shot_Direction_inside_out</th>
      <th>sp_shot_Direction_inside_in</th>
      <th>label</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>48.0</td>
      <td>4</td>
      <td>1</td>
      <td>180.0</td>
      <td>25.8</td>
      <td>0</td>
      <td>185.0</td>
      <td>21.4</td>
      <td>3.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>65.0</td>
      <td>29.0</td>
      <td>22.0</td>
      <td>17.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>128.0</td>
      <td>3</td>
      <td>0</td>
      <td>185.0</td>
      <td>24.0</td>
      <td>1</td>
      <td>196.0</td>
      <td>24.7</td>
      <td>5.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>77.0</td>
      <td>45.0</td>
      <td>21.0</td>
      <td>34.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>32.0</td>
      <td>0</td>
      <td>1</td>
      <td>188.0</td>
      <td>23.7</td>
      <td>1</td>
      <td>185.0</td>
      <td>29.5</td>
      <td>3.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>55.0</td>
      <td>34.0</td>
      <td>15.0</td>
      <td>30.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>128.0</td>
      <td>3</td>
      <td>0</td>
      <td>185.0</td>
      <td>24.9</td>
      <td>1</td>
      <td>185.0</td>
      <td>29.7</td>
      <td>5.0</td>
      <td>...</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>163.0</td>
      <td>104.0</td>
      <td>56.0</td>
      <td>63.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>56.0</td>
      <td>4</td>
      <td>0</td>
      <td>185.0</td>
      <td>25.8</td>
      <td>1</td>
      <td>188.0</td>
      <td>24.9</td>
      <td>3.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>63.0</td>
      <td>66.0</td>
      <td>20.0</td>
      <td>46.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 69 columns</p>
</div>
</div>
</div>
<p>Model without clusters</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>dfc <span class="op">=</span> cluster_class_data.pop(<span class="st">'cluster'</span>) <span class="co"># remove column b and store it in df1</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>dfl <span class="op">=</span> cluster_class_data.pop(<span class="st">'label'</span>) <span class="co"># remove column x and store it in df2</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>cluster_class_data[<span class="st">'cluster'</span>] <span class="op">=</span> dfc <span class="co"># add b series as a 'new' column.</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>cluster_class_data[<span class="st">'label'</span>] <span class="op">=</span>dfl <span class="co"># add b series as a 'new' column.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> cluster_class_data.iloc[:,:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> cluster_class_data.iloc[:, <span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(X,Y,test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>, shuffle<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="61">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> RFECV</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The "accuracy" scoring is proportional to the number of correct classifications</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>clf_rf_4 <span class="op">=</span> RandomForestClassifier() </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>rfecv <span class="op">=</span> RFECV(estimator<span class="op">=</span>clf_rf_4, step<span class="op">=</span><span class="dv">1</span>, cv<span class="op">=</span><span class="dv">5</span>,scoring<span class="op">=</span><span class="st">'accuracy'</span>)   <span class="co">#5-fold cross-validation</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>rfecv <span class="op">=</span> rfecv.fit(x_train, y_train)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Optimal number of features :'</span>, rfecv.n_features_)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Best features :'</span>, x_train.columns[rfecv.support_])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal number of features : 66
Best features : Index(['surface', 'draw_size', 'tourney_level', 'FirstPlayer_hand',
       'FirstPlayer_ht', 'FirstPlayer_age', 'SecondPlayer__hand',
       'SecondPlayer__ht', 'SecondPlayer__age', 'minutes', 'fp_ace', 'fp_df',
       'fp_svpt', 'fp_1stIn', 'fp_1stWon', 'fp_2ndWon', 'fp_SvGms',
       'fp_bpSaved', 'fp_bpFaced', 'sp_ace', 'sp_df', 'sp_svpt', 'sp_1stIn',
       'sp_1stWon', 'sp_2ndWon', 'sp_SvGms', 'sp_bpSaved', 'sp_bpFaced',
       'FirstPlayer_rank', 'SecondPlayer__rank', 'fp_winners_fh',
       'fp_winners_bh', 'fp_unforced_fh', 'fp_unforced_bh',
       'fp_return_pts_faced', 'fp_return_pts_won', 'fp_return_depth_very_deep',
       'fp_return_depth_shallow', 'fp_return_depth_deep',
       'fp_return_depth_err_net', 'fp_return_depth_err_deep',
       'fp_return_depth_err_wide', 'fp_shot_Direction_crosscourt',
       'fp_shot_Direction_down_middle', 'fp_shot_Direction_down_the_line',
       'fp_shot_Direction_inside_out', 'fp_shot_Direction_inside_in',
       'sp_winners_fh', 'sp_winners_bh', 'sp_unforced_fh', 'sp_unforced_bh',
       'sp_return_pts_faced', 'sp_return_pts_won', 'sp_return_depth_very_deep',
       'sp_return_depth_shallow', 'sp_return_depth_deep',
       'sp_return_depth_err_net', 'sp_return_depth_err_deep',
       'sp_return_depth_err_wide', 'sp_return_depth_wide_deep',
       'sp_shot_Direction_crosscourt', 'sp_shot_Direction_down_middle',
       'sp_shot_Direction_down_the_line', 'sp_shot_Direction_inside_out',
       'sp_shot_Direction_inside_in', 'cluster'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="62">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>select_feature <span class="op">=</span> SelectKBest(chi2, k<span class="op">=</span><span class="dv">66</span>).fit(x_train, y_train)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Score list:'</span>, select_feature.scores_)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Feature list:'</span>, x_train.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Score list: [1.39052871e+00 4.50119657e+00 2.29057017e+00 4.49959702e-02
 1.24820662e+00 3.36250690e+00 5.62949268e-03 1.63283191e-01
 2.59859855e-01 1.94173122e-02 8.27596012e+01 9.86409384e+00
 3.43118673e-01 2.11420696e+01 1.85447382e+01 5.63723834e+00
 1.88456380e+00 9.17679146e-01 1.83828343e+01 1.99923834e+01
 4.73691178e+00 3.63178131e+00 7.88294523e+01 4.72981093e+01
 3.23330827e+01 1.93627762e+01 1.02001929e+01 5.14638719e+00
 6.75335361e+00 3.19136133e+02 3.09622174e+02 3.08447508e+00
 9.78092460e+00 1.36328706e+00 1.42177888e+01 7.86659895e+01
 2.76293257e+01 6.99960650e+00 2.01008435e+00 3.70421768e+01
 2.91415670e+00 7.06329766e+00 3.61555865e-01 4.18590244e-03
 7.42768422e+01 1.18855440e+02 6.56675423e+00 5.54470650e+00
 8.61411612e-01 1.89499800e+01 4.03557951e+00 4.88401405e+01
 1.51633266e+01 2.09587227e+01 1.70932878e+01 9.47906596e+00
 3.43067774e+00 2.76708149e+01 8.25370733e-01 2.00411507e+00
 4.19590069e+00 2.87435063e-03 3.31750476e+01 9.99946350e+01
 2.66153124e+01 6.13603175e+01 1.15506403e+01 2.32657990e-01]
Feature list: Index(['surface', 'draw_size', 'tourney_level', 'FirstPlayer_hand',
       'FirstPlayer_ht', 'FirstPlayer_age', 'SecondPlayer__hand',
       'SecondPlayer__ht', 'SecondPlayer__age', 'best_of', 'minutes', 'fp_ace',
       'fp_df', 'fp_svpt', 'fp_1stIn', 'fp_1stWon', 'fp_2ndWon', 'fp_SvGms',
       'fp_bpSaved', 'fp_bpFaced', 'sp_ace', 'sp_df', 'sp_svpt', 'sp_1stIn',
       'sp_1stWon', 'sp_2ndWon', 'sp_SvGms', 'sp_bpSaved', 'sp_bpFaced',
       'FirstPlayer_rank', 'SecondPlayer__rank', 'fp_winners_fh',
       'fp_winners_bh', 'fp_unforced_fh', 'fp_unforced_bh',
       'fp_return_pts_faced', 'fp_return_pts_won', 'fp_return_depth_very_deep',
       'fp_return_depth_shallow', 'fp_return_depth_deep',
       'fp_return_depth_err_net', 'fp_return_depth_err_deep',
       'fp_return_depth_err_wide', 'fp_return_depth_wide_deep',
       'fp_shot_Direction_crosscourt', 'fp_shot_Direction_down_middle',
       'fp_shot_Direction_down_the_line', 'fp_shot_Direction_inside_out',
       'fp_shot_Direction_inside_in', 'sp_winners_fh', 'sp_winners_bh',
       'sp_unforced_fh', 'sp_unforced_bh', 'sp_return_pts_faced',
       'sp_return_pts_won', 'sp_return_depth_very_deep',
       'sp_return_depth_shallow', 'sp_return_depth_deep',
       'sp_return_depth_err_net', 'sp_return_depth_err_deep',
       'sp_return_depth_err_wide', 'sp_return_depth_wide_deep',
       'sp_shot_Direction_crosscourt', 'sp_shot_Direction_down_middle',
       'sp_shot_Direction_down_the_line', 'sp_shot_Direction_inside_out',
       'sp_shot_Direction_inside_in', 'cluster'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="63">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>x_train_2 <span class="op">=</span> select_feature.transform(x_train)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>x_test_2 <span class="op">=</span> select_feature.transform(x_test)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co">#random forest classifier with n_estimators=10 (default)</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>clf_rf_2 <span class="op">=</span> RandomForestClassifier()      </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>clr_rf_2 <span class="op">=</span> clf_rf_2.fit(x_train_2,y_train)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>ac_2 <span class="op">=</span> accuracy_score(y_test,clf_rf_2.predict(x_test_2))</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy is: '</span>,ac_2)</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>cm_2 <span class="op">=</span> confusion_matrix(y_test,clf_rf_2.predict(x_test_2))</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm_2,annot<span class="op">=</span><span class="va">True</span>,fmt<span class="op">=</span><span class="st">"d"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy is:  0.6</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="pre_files/figure-html/cell-64-output-3.png" width="529" height="404"></p>
</div>
</div>
<div class="cell" data-execution_count="64">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>classifier <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>classifier.fit(x_train_2, y_train)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>ac_3 <span class="op">=</span> accuracy_score(y_test,classifier.predict(x_test_2))</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy is: '</span>,ac_3)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>cm_3 <span class="op">=</span> confusion_matrix(y_test,classifier.predict(x_test_2))</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm_3,annot<span class="op">=</span><span class="va">True</span>,fmt<span class="op">=</span><span class="st">"d"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy is:  0.4846153846153846</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="pre_files/figure-html/cell-65-output-3.png" width="529" height="409"></p>
</div>
</div>
<div class="cell" data-execution_count="65">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>svc <span class="op">=</span> SVC()</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>svc <span class="op">=</span> svc.fit(x_train_2,y_train)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>ac_4 <span class="op">=</span> accuracy_score(y_test,svc.predict(x_test_2))</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy is: '</span>,ac_4)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>cm_4 <span class="op">=</span> confusion_matrix(y_test,svc.predict(x_test_2))</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm_4,annot<span class="op">=</span><span class="va">True</span>,fmt<span class="op">=</span><span class="st">"d"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy is:  0.46153846153846156</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="pre_files/figure-html/cell-66-output-3.png" width="541" height="409"></p>
</div>
</div>
<div class="cell" data-execution_count="66">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#random forest classifier with n_estimators=10 (default)</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>clf_rf_2 <span class="op">=</span> RandomForestClassifier()      </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>clr_rf_2 <span class="op">=</span> clf_rf_2.fit(x_train_2,y_train)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>ac_2 <span class="op">=</span> accuracy_score(y_test,clf_rf_2.predict(x_test_2))</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy is: '</span>,ac_2)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>cm_2 <span class="op">=</span> confusion_matrix(y_test,clf_rf_2.predict(x_test_2))</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm_2,annot<span class="op">=</span><span class="va">True</span>,fmt<span class="op">=</span><span class="st">"d"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy is:  0.5769230769230769</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="pre_files/figure-html/cell-67-output-3.png" width="529" height="409"></p>
</div>
</div>
<div class="cell" data-execution_count="67">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>logreg <span class="op">=</span> LogisticRegression()</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>logreg <span class="op">=</span> logreg.fit(x_train_2,y_train)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>ac_2 <span class="op">=</span> accuracy_score(y_test,logreg.predict(x_test_2))</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy is: '</span>,ac_2)</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>cm_2 <span class="op">=</span> confusion_matrix(y_test,logreg.predict(x_test_2))</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm_2,annot<span class="op">=</span><span class="va">True</span>,fmt<span class="op">=</span><span class="st">"d"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/conda/lib/python3.9/site-packages/sklearn/linear_model/_logistic.py:763: ConvergenceWarning:

lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy is:  0.5923076923076923</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="pre_files/figure-html/cell-68-output-4.png" width="541" height="409"></p>
</div>
</div>
<p>Slicing based on the cluster</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>first_cluster_data <span class="op">=</span> cluster_class_data[cluster_class_data[<span class="st">'cluster'</span>] <span class="op">==</span> <span class="fl">0.0</span>] </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>second_cluster_data <span class="op">=</span> cluster_class_data[cluster_class_data[<span class="st">'cluster'</span>] <span class="op">==</span> <span class="dv">1</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>X_c <span class="op">=</span> first_cluster_data.iloc[:,:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>Y_c <span class="op">=</span> first_cluster_data.iloc[:, <span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>xc_train, xc_test, yc_train, yc_test <span class="op">=</span> train_test_split(X_c,Y_c,test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>, shuffle<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="70">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> RFECV</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The "accuracy" scoring is proportional to the number of correct classifications</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>clf_rf_4 <span class="op">=</span> RandomForestClassifier() </span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>rfecv <span class="op">=</span> RFECV(estimator<span class="op">=</span>clf_rf_4, step<span class="op">=</span><span class="dv">1</span>, cv<span class="op">=</span><span class="dv">5</span>,scoring<span class="op">=</span><span class="st">'accuracy'</span>)   <span class="co">#5-fold cross-validation</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>rfecv <span class="op">=</span> rfecv.fit(xc_train, yc_train)</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Optimal number of features :'</span>, rfecv.n_features_)</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Best features :'</span>, xc_train.columns[rfecv.support_])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal number of features : 37
Best features : Index(['FirstPlayer_ht', 'FirstPlayer_age', 'SecondPlayer__ht',
       'SecondPlayer__age', 'minutes', 'fp_ace', 'fp_svpt', 'fp_1stWon',
       'fp_2ndWon', 'fp_bpFaced', 'sp_ace', 'sp_svpt', 'sp_1stIn', 'sp_1stWon',
       'FirstPlayer_rank', 'SecondPlayer__rank', 'fp_winners_fh',
       'fp_unforced_fh', 'fp_return_pts_faced', 'fp_return_pts_won',
       'fp_return_depth_very_deep', 'fp_shot_Direction_crosscourt',
       'fp_shot_Direction_down_middle', 'fp_shot_Direction_down_the_line',
       'fp_shot_Direction_inside_out', 'fp_shot_Direction_inside_in',
       'sp_unforced_fh', 'sp_unforced_bh', 'sp_return_pts_won',
       'sp_return_depth_very_deep', 'sp_return_depth_shallow',
       'sp_return_depth_deep', 'sp_shot_Direction_crosscourt',
       'sp_shot_Direction_down_middle', 'sp_shot_Direction_down_the_line',
       'sp_shot_Direction_inside_out', 'sp_shot_Direction_inside_in'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="71">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>select_feature <span class="op">=</span> SelectKBest(chi2, k<span class="op">=</span><span class="dv">45</span>).fit(xc_train, yc_train)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Score list:'</span>, select_feature.scores_)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Feature list:'</span>, xc_train.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Score list: [1.94444514e-01 8.44836210e+00 7.80196191e-01 3.82145185e-02
 5.39203740e-01 2.10711419e+00 1.31368720e-02 1.57122509e-02
 7.39414145e-01 9.89069514e-03 8.38136237e+01 1.38207978e+00
 1.63304938e-01 2.21296583e+01 1.98047327e+01 8.42640673e+00
 7.25878468e-01 2.01463878e+00 7.55723815e+00 1.18976659e+01
 1.20645300e+00 2.02791598e-01 6.56286510e+01 3.86724678e+01
 2.17968722e+01 2.09671368e+01 8.86566312e+00 3.70460330e+00
 5.08290177e+00 9.89858733e+01 3.00543282e+02 1.41819141e+00
 3.37060808e+00 6.57277708e+00 9.38037862e+00 6.54091346e+01
 2.45420873e+01 3.51692997e+00 2.03911673e+00 2.13958754e+01
 1.90719006e-01 5.07509255e+00 1.30007693e+00 9.46801586e-04
 1.53873075e+02 1.46064483e+02 9.71381321e+00 4.77825342e+00
 3.63453712e-02 1.12168970e+01 3.62715120e+00 4.46919517e+01
 1.39172248e+01 2.19981912e+01 1.68982462e+01 1.91237726e+00
 1.19344314e+00 9.51768650e+00 3.52952568e-02 3.22176887e+00
 7.79744364e+00 2.13030357e-03 1.12221121e+02 7.18226549e+01
 3.03141740e+01 6.96908025e+01 2.61815575e+01            nan]
Feature list: Index(['surface', 'draw_size', 'tourney_level', 'FirstPlayer_hand',
       'FirstPlayer_ht', 'FirstPlayer_age', 'SecondPlayer__hand',
       'SecondPlayer__ht', 'SecondPlayer__age', 'best_of', 'minutes', 'fp_ace',
       'fp_df', 'fp_svpt', 'fp_1stIn', 'fp_1stWon', 'fp_2ndWon', 'fp_SvGms',
       'fp_bpSaved', 'fp_bpFaced', 'sp_ace', 'sp_df', 'sp_svpt', 'sp_1stIn',
       'sp_1stWon', 'sp_2ndWon', 'sp_SvGms', 'sp_bpSaved', 'sp_bpFaced',
       'FirstPlayer_rank', 'SecondPlayer__rank', 'fp_winners_fh',
       'fp_winners_bh', 'fp_unforced_fh', 'fp_unforced_bh',
       'fp_return_pts_faced', 'fp_return_pts_won', 'fp_return_depth_very_deep',
       'fp_return_depth_shallow', 'fp_return_depth_deep',
       'fp_return_depth_err_net', 'fp_return_depth_err_deep',
       'fp_return_depth_err_wide', 'fp_return_depth_wide_deep',
       'fp_shot_Direction_crosscourt', 'fp_shot_Direction_down_middle',
       'fp_shot_Direction_down_the_line', 'fp_shot_Direction_inside_out',
       'fp_shot_Direction_inside_in', 'sp_winners_fh', 'sp_winners_bh',
       'sp_unforced_fh', 'sp_unforced_bh', 'sp_return_pts_faced',
       'sp_return_pts_won', 'sp_return_depth_very_deep',
       'sp_return_depth_shallow', 'sp_return_depth_deep',
       'sp_return_depth_err_net', 'sp_return_depth_err_deep',
       'sp_return_depth_err_wide', 'sp_return_depth_wide_deep',
       'sp_shot_Direction_crosscourt', 'sp_shot_Direction_down_middle',
       'sp_shot_Direction_down_the_line', 'sp_shot_Direction_inside_out',
       'sp_shot_Direction_inside_in', 'cluster'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="72">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>xc_train_2 <span class="op">=</span>select_feature.transform(xc_train)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>xc_test_2 <span class="op">=</span> select_feature.transform(xc_test)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co"># random forest classifier with n_estimators=10 (default)</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>clf_rf_4 <span class="op">=</span> RandomForestClassifier()      </span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>clf_rf_4 <span class="op">=</span> clf_rf_4.fit(xc_train_2,yc_train)</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>ac_2 <span class="op">=</span> accuracy_score(yc_test,clf_rf_4.predict(xc_test_2))</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy is: '</span>,ac_2)</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>cm_2 <span class="op">=</span> confusion_matrix(yc_test,clf_rf_4.predict(xc_test_2))</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm_2,annot<span class="op">=</span><span class="va">True</span>,fmt<span class="op">=</span><span class="st">"d"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy is:  0.5076923076923077</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="pre_files/figure-html/cell-73-output-3.png" width="541" height="409"></p>
</div>
</div>
<div class="cell" data-execution_count="73">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>logreg <span class="op">=</span> LogisticRegression()</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>logreg <span class="op">=</span> logreg.fit(xc_train_2,yc_train)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>ac_4 <span class="op">=</span> accuracy_score(yc_test,logreg.predict(xc_test_2))</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy is: '</span>,ac_4)</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>cm_4 <span class="op">=</span> confusion_matrix(yc_test,logreg.predict(xc_test_2))</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm_4,annot<span class="op">=</span><span class="va">True</span>,fmt<span class="op">=</span><span class="st">"d"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy is:  0.5692307692307692</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/conda/lib/python3.9/site-packages/sklearn/linear_model/_logistic.py:763: ConvergenceWarning:

lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="pre_files/figure-html/cell-74-output-4.png" width="529" height="409"></p>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>X_c1 <span class="op">=</span> first_cluster_data.iloc[:,:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>Y_c1 <span class="op">=</span> first_cluster_data.iloc[:, <span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>xc1_train, xc1_test, yc1_train, yc1_test <span class="op">=</span> train_test_split(X_c1,Y_c1,test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>, shuffle<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell" data-execution_count="75">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>clf_rf_5 <span class="op">=</span> RandomForestClassifier() </span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>rfecv <span class="op">=</span> RFECV(estimator<span class="op">=</span>clf_rf_5, step<span class="op">=</span><span class="dv">1</span>, cv<span class="op">=</span><span class="dv">5</span>,scoring<span class="op">=</span><span class="st">'accuracy'</span>)   <span class="co">#5-fold cross-validation</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>rfecv <span class="op">=</span> rfecv.fit(xc1_train, yc1_train)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Optimal number of features :'</span>, rfecv.n_features_)</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Best features :'</span>, xc1_train.columns[rfecv.support_])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal number of features : 20
Best features : Index(['FirstPlayer_age', 'SecondPlayer__age', 'minutes', 'fp_2ndWon',
       'sp_svpt', 'sp_1stIn', 'FirstPlayer_rank', 'SecondPlayer__rank',
       'fp_return_pts_faced', 'fp_return_pts_won',
       'fp_shot_Direction_crosscourt', 'fp_shot_Direction_down_middle',
       'fp_shot_Direction_down_the_line', 'fp_shot_Direction_inside_out',
       'sp_unforced_fh', 'sp_return_pts_faced', 'sp_return_depth_very_deep',
       'sp_shot_Direction_crosscourt', 'sp_shot_Direction_down_the_line',
       'sp_shot_Direction_inside_out'],
      dtype='object')</code></pre>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> <span class="bu">list</span>(xc1_train.columns[rfecv.support_])</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> scaler.fit_transform(xc1_train)</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> scaler.transform(xc1_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



<script src="pre_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>